<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/wolai.css"/><title>å¹¶æŸ¥é›† - wolai ç¬”è®°</title><link rel="shortcut icon"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="å¹¶æŸ¥é›†" class="main-title"></div></div></header><article><h2 class="wolai-block"><span class="inline-wrap">åŠ¨æ€è¿é€šæ€§</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">é¦–å…ˆæˆ‘ä»¬è¯¦ç»†åœ°è¯´æ˜ä¸€ä¸‹é—®é¢˜ï¼šé—®é¢˜çš„è¾“å…¥æ˜¯ä¸€åˆ—æ•´æ•°å¯¹ï¼Œå…¶ä¸­æ¯ä¸ªæ•´æ•°éƒ½è¡¨ç¤ºä¸€ä¸ªæŸç§ç±»å‹çš„å¯¹è±¡ï¼Œä¸€å¯¹æ•´æ•°<span class="jill"></span>p q<span class="jill"></span>å¯ä»¥è¢«ç†è§£ä¸ºâ€œp<span class="jill"></span>å’Œ<span class="jill"></span>q<span class="jill"></span>æ˜¯ç›¸è¿çš„â€ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">æˆ‘ä»¬å‡è®¾â€œç›¸è¿â€æ˜¯ä¸€ç§ç­‰ä»·å…³ç³»ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å®ƒå…·æœ‰ï¼š</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">âè‡ªåæ€§ï¼šp<span class="jill"></span>å’Œ<span class="jill"></span>p<span class="jill"></span>æ˜¯ç›¸è¿çš„ï¼›âå¯¹ç§°æ€§ï¼šå¦‚æœ<span class="jill"></span>p<span class="jill"></span>å’Œ<span class="jill"></span>q<span class="jill"></span>æ˜¯ç›¸è¿çš„ï¼Œé‚£ä¹ˆ<span class="jill"></span>q<span class="jill"></span>å’Œ<span class="jill"></span>p<span class="jill"></span>ä¹Ÿæ˜¯ç›¸è¿çš„ï¼›</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">âä¼ é€’æ€§ï¼šå¦‚æœ<span class="jill"></span>p<span class="jill"></span>å’Œ<span class="jill"></span>q<span class="jill"></span>æ˜¯ç›¸è¿çš„ä¸”<span class="jill"></span>q<span class="jill"></span>å’Œ<span class="jill"></span>r<span class="jill"></span>æ˜¯ç›¸è¿çš„ï¼Œé‚£ä¹ˆ<span class="jill"></span>p<span class="jill"></span>å’Œ<span class="jill"></span>r<span class="jill"></span>ä¹Ÿæ˜¯ç›¸è¿çš„ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç­‰ä»·å…³ç³»èƒ½å¤Ÿå°†å¯¹è±¡åˆ†ä¸ºå¤šä¸ªç­‰ä»·ç±»ã€‚åœ¨è¿™é‡Œï¼Œå½“ä¸”ä»…å½“ä¸¤ä¸ªå¯¹è±¡ç›¸è¿æ—¶å®ƒä»¬æ‰å±äºåŒä¸€ä¸ªç­‰ä»·ç±»ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå½“ç¨‹åºä»è¾“å…¥ä¸­è¯»å–äº†æ•´æ•°å¯¹<span class="jill"></span>p q<span class="jill"></span>æ—¶ï¼Œå¦‚æœå·²çŸ¥çš„æ‰€æœ‰æ•´æ•°å¯¹éƒ½ä¸èƒ½è¯´æ˜<span class="jill"></span>p<span class="jill"></span>å’Œ<span class="jill"></span>q<span class="jill"></span>æ˜¯ç›¸è¿çš„ï¼Œé‚£ä¹ˆåˆ™å°†è¿™ä¸€å¯¹æ•´æ•°å†™å…¥åˆ°è¾“å‡ºä¸­ã€‚å¦‚æœå·²çŸ¥çš„æ•°æ®å¯ä»¥è¯´æ˜<span class="jill"></span>p<span class="jill"></span>å’Œ<span class="jill"></span>q<span class="jill"></span>æ˜¯ç›¸è¿çš„ï¼Œé‚£ä¹ˆç¨‹åºåº”è¯¥å¿½ç•¥<span class="jill"></span>p q<span class="jill"></span>è¿™å¯¹æ•´æ•°å¹¶ç»§ç»­å¤„ç†è¾“å…¥ä¸­çš„ä¸‹ä¸€å¯¹æ•´æ•°ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä¸ºäº†è¾¾åˆ°æ‰€æœŸæœ›çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„æ¥ä¿å­˜ç¨‹åºå·²çŸ¥çš„æ‰€æœ‰æ•´æ•°å¯¹çš„è¶³å¤Ÿå¤šçš„ä¿¡æ¯ï¼Œå¹¶ç”¨å®ƒä»¬æ¥åˆ¤æ–­ä¸€å¯¹æ–°å¯¹è±¡æ˜¯å¦æ˜¯ç›¸è¿çš„ã€‚æˆ‘ä»¬å°†è¿™ä¸ªé—®é¢˜é€šä¿—åœ°å«åšåŠ¨æ€è¿é€šæ€§é—®é¢˜ã€‚</span></div></div><h2 class="wolai-block"><span class="inline-wrap">Union Find API</span></h2><div class="wolai-block wolai-center"><figure><img src="media/epub_26211947_201.jpeg" style="width: 760px"/></figure></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> UF <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parent<span class="token punctuation">;</span>      <span class="token comment">//ï¼ˆç´¢å¼•ä¸ºè§¦ç‚¹ï¼Œå€¼ä¸ºçˆ¶è§¦ç‚¹ï¼‰</span>
    
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>    <span class="token comment">// åˆ†é‡æ•°é‡</span>

    <span class="token keyword">public</span> <span class="token function">UF</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token class-name">N</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// åˆå§‹åŒ–åˆ†é‡idæ•°ç»„</span>
        count <span class="token operator">=</span> <span class="token class-name">N</span><span class="token punctuation">;</span>
        parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> parent<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">connected</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">Quick-Union</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>parent[]</code></span><span class="inline-wrap">å…ƒç´ éƒ½æ˜¯åŒå¦ä¸€ä¸ªè§¦ç‚¹çš„åç§°ï¼ˆä¹Ÿå¯èƒ½æ˜¯å®ƒè‡ªå·±ï¼‰â€”â€” æˆ‘ä»¬å°†è¿™ç§è”ç³»ç§°ä¸ºé“¾æ¥ã€‚åœ¨å®ç°</span><span class="inline-wrap"><code>find()</code></span><span class="inline-wrap">æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä»ç»™å®šçš„è§¦ç‚¹å¼€å§‹ï¼Œç”±å®ƒçš„é“¾æ¥å¾—åˆ°å¦ä¸€ä¸ªè§¦ç‚¹ï¼Œå†ç”±è¿™ä¸ªè§¦ç‚¹çš„é“¾æ¥åˆ°è¾¾ç¬¬ä¸‰ä¸ªè§¦ç‚¹ï¼Œå¦‚æ­¤ç»§ç»­è·Ÿéšç€é“¾æ¥ç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæ ¹è§¦ç‚¹ï¼Œå³é“¾æ¥æŒ‡å‘è‡ªå·±çš„è§¦ç‚¹</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        p <span class="token operator">=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> parent1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> parent2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent1 <span class="token operator">==</span> parent2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ç»Ÿä¸€æ ¹èŠ‚ç‚¹</span>
    parent<span class="token punctuation">[</span>parent1<span class="token punctuation">]</span> <span class="token operator">=</span> parent2<span class="token punctuation">;</span>
    count<span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">åŠ æƒ<span class="jill"></span>Quick-Union</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä¸å…¶åœ¨</span><span class="inline-wrap"><code>union()</code></span><span class="inline-wrap">ä¸­éšæ„å°†ä¸€æ£µæ ‘è¿æ¥åˆ°å¦ä¸€æ£µæ ‘ï¼Œæˆ‘ä»¬ç°åœ¨ä¼šè®°å½•æ¯ä¸€æ£µæ ‘çš„å¤§å°å¹¶æ€»æ˜¯å°†è¾ƒå°çš„æ ‘è¿æ¥åˆ°è¾ƒå¤§çš„æ ‘ä¸Šã€‚è¿™é¡¹æ”¹åŠ¨éœ€è¦æ·»åŠ ä¸€ä¸ªæ•°ç»„å’Œä¸€äº›ä»£ç æ¥è®°å½•æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ï¼Œä½†å®ƒèƒ½å¤Ÿå¤§å¤§æ”¹è¿›ç®—æ³•çš„æ•ˆç‡ã€‚æˆ‘ä»¬å°†å®ƒç§°ä¸ºåŠ æƒ<span class="jill"></span>quick-union<span class="jill"></span>ç®—æ³•</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeightedQuickUnionUF</span> <span class="token punctuation">{</span>

      <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parent<span class="token punctuation">;</span>      <span class="token comment">// çˆ¶é“¾æ¥æ•°ç»„ï¼ˆç”±è§¦ç‚¹ç´¢å¼•ï¼‰</span>
      <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rank<span class="token punctuation">;</span>      <span class="token comment">//ï¼ˆç”±è§¦ç‚¹ç´¢å¼•çš„ï¼‰å„ä¸ªæ ¹èŠ‚ç‚¹æ‰€å¯¹åº”çš„åˆ†é‡çš„å¤§å°</span>
      <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>    <span class="token comment">// è¿é€šåˆ†é‡çš„æ•°é‡</span>

      <span class="token keyword">public</span> <span class="token class-name">WeightedQuickUnionUF</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token class-name">N</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          count <span class="token operator">=</span> <span class="token class-name">N</span><span class="token punctuation">;</span>
          parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          rank <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            parent<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
            rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> count<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">connected</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// è·Ÿéšé“¾æ¥æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span>
          <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> id<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              p <span class="token operator">=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> p<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token comment">// å°†å°æ ‘çš„æ ¹èŠ‚ç‚¹è¿æ¥åˆ°å¤§æ ‘çš„æ ¹èŠ‚ç‚¹</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> rank<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              parent<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rank<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              parent<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
              parent<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
              rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          count<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä¸Šé¢ä»£ç çš„èŠ‚ç‚¹éƒ½æ˜¯</span><span class="inline-wrap"><code>int</code></span><span class="inline-wrap">ç±»å‹çš„ï¼Œå¦‚æœè¦æ¥æ”¶å¯¹è±¡ï¼Œé‚£è¦æ€ä¹ˆå†™ï¼Ÿ</span></div></div><aside class="bg-cultured wolai-block"><div data-symbol="ğŸ’¥" class="icon"></div><span class="inline-wrap">å…¶å®å°±æ˜¯æŠŠæ•°ç»„æ¢æˆ<span class="jill"></span>Map<span class="jill"></span>å°±å¯ä»¥äº†ï¼Œæ•°ç»„å…¶å®å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„<span class="jill"></span>Mapï¼ŒMap&lt;Integer,T&gt;</span></aside><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UnionFind</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">></span></span> parentMap<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> rankMap<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> elements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parentMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rankMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">T</span> element <span class="token operator">:</span> elements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
            rankMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        count <span class="token operator">=</span> elements<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">T</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">T</span> current <span class="token operator">=</span> element<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">T</span> parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> current<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            current <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token class-name">T</span> element1<span class="token punctuation">,</span> <span class="token class-name">T</span> element2<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">T</span> parent1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>element1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">T</span> parent2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>element2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// check if the elements are already in the same set</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>parent2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> sz1 <span class="token operator">=</span> sizeMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parent1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> sz2 <span class="token operator">=</span> sizeMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parent2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sz1 <span class="token operator">&lt;</span> sz2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent1<span class="token punctuation">,</span> parent2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sz2 <span class="token operator">&lt;</span> sz1<span class="token punctuation">)</span><span class="token punctuation">{</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent2<span class="token punctuation">,</span> parent1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent2<span class="token punctuation">,</span> parent1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            sizeMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent1<span class="token punctuation">,</span> sz1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        count<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">connected</span><span class="token punctuation">(</span><span class="token class-name">T</span> element1<span class="token punctuation">,</span> <span class="token class-name">T</span> element2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">find</span><span class="token punctuation">(</span>element1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>element2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">è·¯å¾„å‹ç¼©çš„</span><span class="inline-wrap">åŠ æƒ<span class="jill"></span>Quick-Union</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ªèŠ‚ç‚¹éƒ½ç›´æ¥é“¾æ¥åˆ°å®ƒçš„æ ¹èŠ‚ç‚¹ä¸Šï¼Œä½†æˆ‘ä»¬åˆä¸æƒ³åƒ<span class="jill"></span>quick-find<span class="jill"></span>ç®—æ³•é‚£æ ·é€šè¿‡ä¿®æ”¹å¤§é‡é“¾æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬æ¥è¿‘è¿™ç§ç†æƒ³çŠ¶æ€çš„æ–¹å¼å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨æ£€æŸ¥èŠ‚ç‚¹çš„åŒæ—¶å°†å®ƒä»¬ç›´æ¥é“¾æ¥åˆ°æ ¹èŠ‚ç‚¹ã€‚è¿™ç§æ–¹æ³•ä¹ä¸€çœ‹å¾ˆæ¿€è¿›ï¼Œä½†å®ƒçš„å®ç°éå¸¸å®¹æ˜“ï¼Œè€Œä¸”è¿™äº›æ ‘å¹¶æ²¡æœ‰é˜»æ­¢æˆ‘ä»¬è¿›è¡Œè¿™ç§ä¿®æ”¹çš„ç‰¹æ®Šç»“æ„ï¼šå¦‚æœè¿™ä¹ˆåšèƒ½å¤Ÿæ”¹è¿›ç®—æ³•çš„æ•ˆç‡ï¼Œæˆ‘ä»¬å°±åº”è¯¥å®ç°å®ƒã€‚è¦å®ç°è·¯å¾„å‹ç¼©ï¼Œåªéœ€è¦ä¸º</span><span class="inline-wrap"><code>find()</code></span><span class="inline-wrap">æ·»åŠ ä¸€ä¸ªå¾ªç¯ï¼Œå°†åœ¨è·¯å¾„ä¸Šé‡åˆ°çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ç›´æ¥é“¾æ¥åˆ°æ ¹èŠ‚ç‚¹ã€‚æˆ‘ä»¬æ‰€å¾—åˆ°çš„ç»“æœæ˜¯å‡ ä¹å®Œå…¨æ‰å¹³åŒ–çš„æ ‘ï¼Œå®ƒå’Œ<span class="jill"></span>quick-find<span class="jill"></span>ç®—æ³•ç†æƒ³æƒ…å†µä¸‹æ‰€å¾—åˆ°çš„æ ‘éå¸¸æ¥è¿‘ã€‚</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UnionFind</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">></span></span> parentMap<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> rankMap<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> elements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parentMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rankMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">T</span> element <span class="token operator">:</span> elements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
            rankMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        count <span class="token operator">=</span> elements<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">T</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ‰¾åˆ°è·ŸèŠ‚ç‚¹</span>
        <span class="token class-name">T</span> current <span class="token operator">=</span> element<span class="token punctuation">;</span>
        <span class="token class-name">T</span> parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            current <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æŠŠå½“å‰èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„èŠ‚ç‚¹æŒ‚åˆ°è·ŸèŠ‚ç‚¹ä¸‹</span>
        <span class="token keyword">final</span> <span class="token class-name">T</span> root <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        current <span class="token operator">=</span> element<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
            current <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> root<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token class-name">T</span> element1<span class="token punctuation">,</span> <span class="token class-name">T</span> element2<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">T</span> parent1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>element1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">T</span> parent2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>element2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// check if the elements are already in the same set</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>parent2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> rank1 <span class="token operator">=</span> rankMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parent1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> rank2 <span class="token operator">=</span> rankMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parent2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rank1 <span class="token operator">></span> rank2<span class="token punctuation">)</span> parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent2<span class="token punctuation">,</span> parent1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rank1 <span class="token operator">&lt;</span> rank2<span class="token punctuation">)</span> parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent1<span class="token punctuation">,</span> parent2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent2<span class="token punctuation">,</span> parent1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            rankMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>parent1<span class="token punctuation">,</span> rank1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        count<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">connected</span><span class="token punctuation">(</span><span class="token class-name">T</span> element1<span class="token punctuation">,</span> <span class="token class-name">T</span> element2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>element1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>element2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">200.å²›å±¿æ•°é‡</span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numIslands</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> elems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span> elems<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">getKey</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">UnionFind</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> uf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UnionFind</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> grid<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> grid<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span>
                    uf<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token function">getKey</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getKey</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span>
                    uf<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token function">getKey</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getKey</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> uf<span class="token punctuation">.</span>total<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> j<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">UnionFind</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">></span></span> parentMap<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> rankMap<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">int</span> total<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">UnionFind</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> elems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            parentMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            rankMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">T</span> elem <span class="token operator">:</span> elems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
                rankMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            total <span class="token operator">=</span> elems<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">T</span> elem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‰¾å‡ºelemçš„ç¥–å…ˆ</span>
            <span class="token class-name">T</span> current <span class="token operator">=</span> elem<span class="token punctuation">;</span>
            <span class="token class-name">T</span> parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                current <span class="token operator">=</span> parent<span class="token punctuation">;</span>
                parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// elemåˆ°rootä¹‹é—´çš„å…ƒç´ ,æŒ‚åˆ°rootä¸‹</span>
            <span class="token class-name">T</span> root <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            current <span class="token operator">=</span> elem<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                parent <span class="token operator">=</span> parentMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
                parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
                current <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> root<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token class-name">T</span> elem1<span class="token punctuation">,</span> <span class="token class-name">T</span> elem2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">T</span> root1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>elem1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">T</span> root2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>elem2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>root1<span class="token punctuation">,</span> root2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

            <span class="token class-name">Integer</span> rank1 <span class="token operator">=</span> rankMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>root1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Integer</span> rank2 <span class="token operator">=</span> rankMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>root2<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>rank1 <span class="token operator">></span> rank2<span class="token punctuation">)</span> parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>root2<span class="token punctuation">,</span> root1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rank2 <span class="token operator">></span> rank1<span class="token punctuation">)</span> parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>root1<span class="token punctuation">,</span> root2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                parentMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>root1<span class="token punctuation">,</span> root2<span class="token punctuation">)</span><span class="token punctuation">;</span>
                rankMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>root2<span class="token punctuation">,</span> rank2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            total<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block></details></article><footer></footer></body></html>