<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/wolai.css"/><title>å“ˆå¸Œè¡¨ - wolai ç¬”è®°</title><link rel="shortcut icon"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="å“ˆå¸Œè¡¨" class="main-title"></div></div></header><article><h2 class="wolai-block"><span class="inline-wrap">ç®€ä»‹</span></h2><aside class="bg-cultured wolai-block"><div data-symbol="ğŸ’¥" class="icon"></div><span class="inline-wrap">å“ˆå¸Œè¡¨å…¶å®å°±æ˜¯ç”±</span><span class="orange inline-wrap"><b>å“ˆå¸Œå‡½æ•°</b></span><span class="inline-wrap">åŠ </span><span class="orange inline-wrap"><b>æ•°ç»„</b></span><span class="inline-wrap">æ‰€ç»„æˆçš„ä¸€ç§æ•°æ®ç»“æ„ã€‚</span></aside><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¦‚æœæ‰€æœ‰çš„é”®éƒ½æ˜¯å°æ­£æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥å®ç°ä¸€ä¸ª<span class="jill"></span>Mapã€‚å°†é”®ä½œä¸ºæ•°ç»„çš„ç´¢å¼•ï¼Œç´¢å¼•æ‰€å¯¹åº”çš„ä½ç½®å­˜æ”¾é”®å¯¹åº”çš„å€¼ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæ‰€æœ‰é”®éƒ½æ˜¯å°æ­£æ•°çš„æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå°‘è§çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œå¯ä»¥æŠŠé”®è½¬åŒ–ä¸ºæ•°ç»„çš„ç´¢å¼•ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å“ˆå¸Œè¡¨çš„æŸ¥æ‰¾ç®—æ³•ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†è¢«æŸ¥æ‰¾çš„é”®è½¬åŒ–ä¸ºæ•°ç»„çš„ä¸€ä¸ªç´¢å¼•ã€‚ç¬¬äºŒæ­¥å°±æ˜¯å¤„ç†å“ˆå¸Œå†²çªï¼Œå› ä¸ºä¸åŒçš„é”®é€šè¿‡åŒä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œå¯èƒ½ä¼šäº§ç”Ÿç›¸åŒçš„ç´¢å¼•ï¼Œè§£å†³å“ˆå¸Œå†²çªçš„å¸¸è§æ–¹æ³•æœ‰</span><span class="inline-wrap"><b>æ‹‰é“¾æ³•</b></span><span class="inline-wrap">å’Œ</span><span class="inline-wrap"><b>çº¿æ€§æ¢æµ‹æ³•</b></span><span class="inline-wrap">ã€‚</span></div></div><h2 class="wolai-block"><span class="inline-wrap">å“ˆå¸Œå‡½æ•°</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">å“ˆå¸Œå‡½æ•°ä¸é”®çš„æ•°æ®ç±»å‹æœ‰å…³ï¼Œä¸¥æ ¼æ¥è¯´ï¼Œå¯¹äºæ¯ç§ç±»å‹çš„é”®æˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„å“ˆå¸Œå‡½æ•°ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¦‚æœé”®æ˜¯ä¸€ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ•°ï¼Œå¦‚æœé”®æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•°ã€‚ç­‰ç­‰ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å…¶å®<span class="jill"></span>Java<span class="jill"></span>å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†å“ˆå¸Œå‡½æ•°çš„é»˜è®¤å®ç°ï¼Œåœ¨<span class="jill"></span>Object<span class="jill"></span>ç±»ä¸­å°±æœ‰ä¸€ä¸ª<span class="jill"></span>hashCode<span class="jill"></span>æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª<span class="jill"></span>int<span class="jill"></span>ç±»å‹çš„æ•´æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡å†™è¯¥æ–¹æ³•ï¼Œè½»æ¾ä¸ºè‡ªå·±çš„æŠ½è±¡ç±»å‹å®ç°ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä¸è¿‡äº†è§£å¤šä¸€ç‚¹çŸ¥è¯†ï¼Œæ€»æ˜¯æ²¡æœ‰åçš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›å…¸å‹çš„å“ˆå¸Œå‡½æ•°ã€‚</span></div></div><h3 class="wolai-block"><span class="inline-wrap">æ­£æ•´æ•°</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä½œç”¨äºæ•´æ•°çš„å“ˆå¸Œå‡½æ•°çš„æœ€å¸¸ç”¨çš„å®ç°æ–¹æ³•å°±æ˜¯</span><span class="inline-wrap"><b>ä½™æ•°æ³•</b></span><span class="inline-wrap">ã€‚å‡è®¾æ•°ç»„å¤§å°ä¸º<span class="jill"></span>Mï¼Œå¯¹äºä»»æ„æ­£æ•´æ•°<span class="jill"></span>Kï¼Œè®¡ç®—<span class="jill"></span>K<span class="jill"></span>é™¤ä»¥<span class="jill"></span>M<span class="jill"></span>çš„ä½™æ•°ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªç´¢å¼•ä½ç½®ã€‚</span></div></div><h3 class="wolai-block"><span class="inline-wrap">æµ®ç‚¹æ•°</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¦‚æœé”®æ˜¯<span class="jill"></span>0<span class="jill"></span>åˆ°<span class="jill"></span>1<span class="jill"></span>ä¹‹é—´çš„å®æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä¹˜ä»¥<span class="jill"></span>M<span class="jill"></span>ç„¶åå››èˆäº”å…¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª<span class="jill"></span>0 ~ (M-1)ä¹‹é—´çš„ç´¢å¼•å€¼ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¦‚æœæ˜¯å¤§äº<span class="jill"></span>1<span class="jill"></span>çš„ï¼Œé‚£ä¹ˆå°±ç›´æ¥å››èˆäº”å…¥ï¼Œç„¶åç”¨ä½™æ•°æ³•ã€‚</span></div></div><h3 class="wolai-block"><span class="inline-wrap">å­—ç¬¦ä¸²</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java<span class="jill"></span>ä¸­çš„<span class="jill"></span>charAt<span class="jill"></span>æ–¹æ³•èƒ½è¿”å›ä¸€ä¸ª<span class="jill"></span>char<span class="jill"></span>å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªéè´Ÿ<span class="jill"></span>16<span class="jill"></span>ä½æ•´æ•°ã€‚</span></div></div><h3 class="wolai-block"><span class="inline-wrap">é‡å†™<span class="jill"></span>hashCode<span class="jill"></span>æ–¹æ³•</span></h3><h3 class="wolai-block"><span class="inline-wrap">é‡å†™<span class="jill"></span>equals<span class="jill"></span>æ–¹æ³•</span></h3><h2 class="wolai-block"><span class="inline-wrap">åŸºäºæ‹‰é“¾æ³•çš„å“ˆå¸Œè¡¨</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">æ‹‰é“¾æ³•æ˜¯è§£å†³å“ˆå¸Œå†²çªçš„ä¸€ç§æ–¹æ³•ï¼Œæœ¬è´¨å°±æ˜¯å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æŒ‡å‘ä¸€æ¡é“¾æ¡ï¼Œä½¿ç”¨è¯¥é“¾è¡¨æ¥å­˜å‚¨æ•°æ®ã€‚</span></div></div><h2 class="wolai-block"><span class="inline-wrap">åŸºäºçº¿æ€§æ¢æµ‹æ³•çš„å“ˆå¸Œè¡¨</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">è§£å†³å“ˆå¸Œå†²çªçš„å¦ä¸€ç§æ–¹å¼æ˜¯ç”¨å¤§å°ä¸º<span class="jill"></span>M<span class="jill"></span>çš„æ•°ç»„ä¿å­˜<span class="jill"></span>N<span class="jill"></span>ä¸ªé”®å€¼å¯¹ï¼Œå…¶ä¸­<span class="jill"></span>M&gt;Nã€‚æˆ‘ä»¬ä¾é æ•°ç»„ä¸­çš„ç©ºä½è§£å†³ç¢°æ’å†²çªã€‚åŸºäºè¿™ç§ç­–ç•¥çš„æ‰€æœ‰æ–¹æ³•ç»Ÿç§°ä¸º</span><span class="inline-wrap"><b>å¼€æ”¾åœ°å€å“ˆå¸Œè¡¨</b></span><span class="inline-wrap">ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å…¶ä¸­æœ€ç®€å•çš„æ–¹æ³•å«åšçº¿æ€§æ¢æµ‹æ³•ã€‚æ’å…¥å…ƒç´ æ—¶ï¼Œå½“å¯¹åº”ä½ç½®å·²å­˜æœ‰å…ƒç´ ï¼Œåˆ™æŸ¥çœ‹ä¸‹ä¸€ä¸ªä½ç½®ï¼ˆç´¢å¼•<span class="jill"></span>+1ï¼‰ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºé—²ä½ç½®ã€‚</span></div></div><h2 class="wolai-block"><span class="inline-wrap">è°ƒæ•´æ•°ç»„å¤§å°</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">åˆ›å»ºæ–°çš„å“ˆå¸Œè¡¨ï¼Œéå†æ—§çš„å“ˆå¸Œè¡¨æŠŠå…ƒç´ é‡æ–°æ’å…¥æ–°çš„å“ˆå¸Œè¡¨ã€‚</span></div></div><h1 class="wolai-block"><span class="inline-wrap">JDK HashMap<span class="jill"></span>æºç è§£æ</span></h1><div class="wolai-bookmark wolai-block"><a href="https://github.com/hexffff0/read-java-11/blob/master/java.base/java/util/HashMap.java">read-java-11/HashMap.java at master Â· hexffff0/read-java-11</a><div class="info-box"><div class="text-pane"><div data-title="read-java-11/HashMap.java at master Â· hexffff0/read-java-11"></div><div data-desc="é˜…è¯»Java11æºç ğŸ˜€. Contribute to hexffff0/read-java-11 development by creating an account on GitHub."></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://github.com/fluidicon.png&quot;)"></div><div data-hostname="github.com"></div></div></div><div class="preview-pane" style="background-image: url(https://opengraph.githubassets.com/d8a651b938f0906658cd305d741f35178b6b38095addde920337d5fd8d4f749b/hexffff0/read-java-11)"></div></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java<span class="jill"></span>ä¸­å¯¹å“ˆå¸Œè¡¨çš„å®ç°æ˜¯<span class="jill"></span>HashMapã€‚å®ƒèƒ½æ¥å—<span class="jill"></span>nullï¼Œæ— è®ºæ˜¯<span class="jill"></span>key<span class="jill"></span>è¿˜æ˜¯<span class="jill"></span>valueã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">HashMap<span class="jill"></span>ä¸­çš„å‡ ä¸ªé‡è¦å±æ€§å‚æ•°</span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">size è®°å½•äº†<span class="jill"></span>Map<span class="jill"></span>ä¸­<span class="jill"></span>KV<span class="jill"></span>å¯¹çš„ä¸ªæ•°</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">capacity å“ˆå¸Œè¡¨æ•°ç»„å¤§å°</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">loadFactor è´Ÿè½½å› å­ï¼Œç”¨æ¥è¡¡é‡<span class="jill"></span>HashMap<span class="jill"></span>æ»¡çš„ç¨‹åº¦ï¼ŒloadFactor=size/capacity</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">threshold ä¸´ç•Œå€¼ï¼Œå½“å®é™…<span class="jill"></span>KV<span class="jill"></span>ä¸ªæ•°è¶…è¿‡ä¸´ç•Œå€¼æ—¶ï¼ŒHashMap<span class="jill"></span>å°†è¢«æ‰©å®¹ï¼Œthreshold=capacity*loadFactor</span></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap">åœ¨çœ‹æºç ä¹‹å‰ï¼Œéœ€è¦æœ‰ç‚¹ä½è¿ç®—çš„çŸ¥è¯†ã€‚</span><span class="inline-wrap"><a href="https://blog.csdn.net/briblue/article/details/70296326"><span>å¯èƒ½æ˜¯æœ€é€šä¿—æ˜“æ‡‚çš„ä½è¿ç®—è®²è§£</span></a></span><span class="inline-wrap">ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">æºç åœ°å€</span></div></div><h2 class="wolai-block"><span class="inline-wrap">Put<span class="jill"></span>å‡½æ•°çš„å®ç°</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">1.HashMap<span class="jill"></span>åº•å±‚ä½¿ç”¨</span><span class="inline-wrap"><code>Node&lt;K,V&gt;[]</code></span><span class="inline-wrap">æ¥è¡¨ç¤ºä¸€ä¸ªé”®å€¼å¯¹</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">transient</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span> <span class="token comment">// ç”¨transientå…³é”®å­—æ ‡è®°çš„æˆå‘˜å˜é‡ä¸å‚ä¸åºåˆ—åŒ–è¿‡ç¨‹</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> hash<span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">K</span> key<span class="token punctuation">;</span>
    <span class="token class-name">V</span> value<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">;</span>

    <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hash <span class="token operator">=</span> hash<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// getterã€setter</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">K</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span> <span class="token keyword">return</span> key<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">{</span> <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    
  <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token class-name">V</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">V</span> oldValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
        value <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
        <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// é‡å†™toString</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> key <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">// é‡å†™hashCode</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é‡å†™equals</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">></span></span> e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>o<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">2.å¯¹<span class="jill"></span>key<span class="jill"></span>è¿›è¡Œ<span class="jill"></span>hash<span class="jill"></span>è¿ç®—ï¼Œkey<span class="jill"></span>çš„<span class="jill"></span>hashCode<span class="jill"></span>ä½<span class="jill"></span>16<span class="jill"></span>ä½ä¸é«˜<span class="jill"></span>16<span class="jill"></span>ä½å¼‚æˆ–ã€‚</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">3.æ ¹æ®<span class="jill"></span>hash<span class="jill"></span>å€¼è®¡ç®—å‡ºç´¢å¼•</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash <span class="token comment">// næ˜¯å“ˆå¸Œè¡¨çš„å®¹é‡</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">4.æ ¹æ®ç´¢å¼•ä»å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾å…ƒç´ </span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥å“ˆå¸Œè¡¨</span><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å¦‚æœå…ƒç´ å­˜åœ¨</span><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">åˆ¤æ–­<span class="jill"></span>key<span class="jill"></span>æ˜¯å¦ç›¸åŒï¼Œç›¸åŒåˆ™ä¿®æ”¹<span class="jill"></span>value</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼ˆTreeNodeï¼‰ï¼Œä»çº¢é»‘æ ‘æ‰¾å‡ºèŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºï¼Œç„¶åå†™å…¥<span class="jill"></span>value</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å‰©ä½™å°±æ˜¯é“¾è¡¨äº†ï¼Œéå†é“¾è¡¨ï¼Œå¦‚æœä¸å­˜åœ¨èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦éœ€è¦è½¬æ¢æˆçº¢é»‘æ ‘ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹<span class="jill"></span>value</span></li></ul></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>æºç </b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span>
               <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> 
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> p<span class="token punctuation">;</span> 
    <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token comment">// å½“å‰æ•°ç»„é•¿åº¦</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// è¯¥å…ƒç´ å¯¹åº”æ•°ç»„ä¸­çš„ç´¢å¼•</span>
    
    <span class="token comment">// å¦‚æœå“ˆå¸Œè¡¨è¿˜æ²¡åˆå§‹åŒ–æˆ–è€…å“ˆå¸Œè¡¨å®¹é‡ä¸º0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
   
    <span class="token comment">// i = (n - 1) &amp; hash hashå€¼ä¸ç´¢å¼•çš„å…³ç³»</span>
    <span class="token comment">// å…¶å®å°±æ˜¯å–æ¨¡ï¼Œä¸¤ä¸ªæ­£æ•´æ•°å–æ¨¡ç­‰äºä¸¤ä¸ªæ­£æ•°çš„ä¸è¿ç®—</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// ç´¢å¼•æ‰€å¯¹åº”çš„ä½ç½®æ²¡æœ‰å…ƒç´ </span>
        tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// å“ˆå¸Œå†²çª</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span> 
        <span class="token class-name">K</span> k<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
            <span class="token comment">// åˆ¤æ–­æ˜¯å¦å·²ç»ç”±é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// éå†é“¾è¡¨</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// é“¾è¡¨æœ€åæ’å…¥æ–°å…ƒç´ </span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">>=</span> TREEIFY_THRESHOLD <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> 
                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é“¾è¡¨å¤ªé•¿ï¼Œå°è¯•è½¬åŒ–ä¸ºçº¢é»‘æ ‘</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                p <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// existing mapping for key</span>
            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">></span> threshold<span class="token punctuation">)</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">GET<span class="jill"></span>å‡½æ•°çš„å®ç°</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> first<span class="token punctuation">,</span> e<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>first <span class="token operator">=</span> tab<span class="token punctuation">[</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token comment">// always check first node</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> first<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> first<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>first<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">do</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">å¹¶å‘æ“ä½œ<span class="jill"></span>HashMap<span class="jill"></span>é€ æˆæ­»é”</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">åœ¨<span class="jill"></span>1.7<span class="jill"></span>ä¸­ï¼Œå½“æ•°æ®<span class="jill"></span>put<span class="jill"></span>è¿›<span class="jill"></span>HashMap<span class="jill"></span>çš„æ—¶å€™ï¼Œéƒ½ä¼šæ¯”è¾ƒå’Œ</span><span class="inline-wrap"><code>thredhold</code></span><span class="inline-wrap">çš„å¤§å°ï¼Œå½“è¶…è¿‡ä¸´ç•Œå€¼çš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œæ‰©å®¹æ“ä½œï¼Œå°±ä¼šè°ƒç”¨</span><span class="inline-wrap"><code>resize()</code></span><span class="inline-wrap">æ–¹æ³•ã€‚è€Œ</span><span class="inline-wrap"><code>resize()</code></span><span class="inline-wrap">ä¸­è°ƒç”¨äº†</span><span class="inline-wrap"><code>transfer</code></span><span class="inline-wrap">æ–¹æ³•ã€‚ä¸‹é¢ç®€å•çš„çœ‹çœ‹</span><span class="inline-wrap"><code>transfer</code></span><span class="inline-wrap">æ–¹æ³•ã€‚</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// -----------------------------------------------------</span>
            e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
            newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span> 
            <span class="token comment">// è½¬ç§»çš„æ—¶å€™æ˜¯é€†åºçš„ã€‚å‡å¦‚è½¬ç§»å‰é“¾è¡¨é¡ºåºæ˜¯1->2->3ï¼Œé‚£ä¹ˆè½¬ç§»åå°±ä¼šå˜æˆ3->2->1ã€‚</span>
            <span class="token comment">// ------------------------------------------------------</span>
            e <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">å‡è®¾ä¸¤ä¸ªçº¿ç¨‹è¿›å…¥äº†</span><span class="inline-wrap"><code>transfer</code></span><span class="inline-wrap">æ–¹æ³•ã€‚æ—§è¡¨ä¸­ç´¢å¼•ä¸º<span class="jill"></span>X<span class="jill"></span>çš„åœ°æ–¹å­˜å‚¨äº†ä¸€ä¸ª<span class="jill"></span>1-&gt;2-&gt;3<span class="jill"></span>çš„é“¾è¡¨ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">çº¿ç¨‹<span class="jill"></span>1<span class="jill"></span>åœ¨æ–°è¡¨ä¸­ç´¢å¼•ä¸º<span class="jill"></span>X<span class="jill"></span>çš„åœ°æ–¹å·²ç»å­˜å‚¨äº†<span class="jill"></span>2-&gt;1<span class="jill"></span>çš„é“¾è¡¨,ç„¶åè¯¥çº¿ç¨‹è¢«åˆ‡æ¢äº†ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">çº¿ç¨‹<span class="jill"></span>2<span class="jill"></span>åœ¨å¯¹æ—§è¡¨ä¸­ç´¢å¼•ä¸º<span class="jill"></span>X<span class="jill"></span>çš„åœ°æ–¹è¿›è¡Œæ“ä½œï¼Œå®ƒç›®å‰æ“ä½œçš„æ˜¯<span class="jill"></span>1ï¼Œå®ƒæŠŠ<span class="jill"></span>1<span class="jill"></span>æ’å…¥åˆ°äº†æ–°è¡¨ä¸­ç´¢å¼•ä¸º<span class="jill"></span>X<span class="jill"></span>çš„åœ°æ–¹</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç°åœ¨æ–°è¡¨ä¸­ç´¢å¼•ä¸º<span class="jill"></span>X<span class="jill"></span>çš„åœ°æ–¹å­˜å‚¨çš„æ˜¯<span class="jill"></span>1-&gt;2-&gt;1ï¼Œå½¢æˆäº†ä¸€ä¸ªå¾ªç¯å¼•ç”¨ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">åœ¨<span class="jill"></span>1.8<span class="jill"></span>ä¸­ï¼Œ</span><span class="inline-wrap"><code>resize</code></span><span class="inline-wrap">æ–¹æ³•æ²¡æœ‰ä½¿ç”¨</span><span class="inline-wrap"><code>transfer</code></span><span class="inline-wrap">æ–¹æ³•ï¼Œä¸ä¼šå› ä¸ºå¤šçº¿ç¨‹</span><span class="inline-wrap"><code>put</code></span><span class="inline-wrap">å¯¼è‡´æ­»å¾ªç¯ï¼Œä½†æ˜¯ä¾ç„¶æœ‰å…¶ä»–çš„å¼Šç«¯ï¼Œæ¯”å¦‚æ•°æ®ä¸¢å¤±ç­‰ã€‚å› æ­¤å¤šçº¿ç¨‹æƒ…å†µä¸‹è¿˜æ˜¯å»ºè®®ä½¿ç”¨</span><span class="inline-wrap"><code>ConcurrentHashMap</code></span></div></div><h1 class="wolai-block"><span class="inline-wrap">HashMap<span class="jill"></span>å¸¸è§é¢è¯•é¢˜</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-bookmark wolai-block"><a href="https://juejin.cn/post/6844903921190699022">HashMapé¢è¯•å¿…é—®çš„6ä¸ªç‚¹ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ</a><div class="info-box"><div class="text-pane"><div data-title="HashMapé¢è¯•å¿…é—®çš„6ä¸ªç‚¹ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ"></div><div data-desc="é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œå—¯ï¼Œå½“ç„¶æ˜¯å¿…é¡»çœ‹è¿‡HashMapæºç ã€‚è‡³äºåŸç†ï¼Œä¸‹é¢é‚£å¼ å›¾å¾ˆæ¸…æ¥šäº†: HashMapé‡‡ç”¨Entryæ•°ç»„æ¥å­˜å‚¨key-valueå¯¹ï¼Œæ¯ä¸€ä¸ªé”®å€¼å¯¹ç»„æˆäº†ä¸€ä¸ªEntryå®ä½“ï¼ŒEntryç±»å®é™…ä¸Šæ˜¯ä¸€ä¸ªå•å‘çš„é“¾è¡¨ç»“æ„ï¼Œå®ƒå…·æœ‰NextæŒ‡é’ˆï¼Œå¯ä»¥è¿æ¥ä¸‹ä¸€ä¸ªEntryå®ä½“ã€‚ æ•°ç»„â€¦"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web//static/favicons/apple-touch-icon.png&quot;)"></div><div data-hostname="juejin.cn"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://www.zhihu.com/question/366679456/answer/1036854619">ä¸ºä»€ä¹ˆjavaçš„hashmapä¸æ”¯æŒåŠ¨æ€ç¼©å°å®¹é‡ï¼Ÿ - çŸ¥ä¹</a><div class="info-box"><div class="text-pane"><div data-title="ä¸ºä»€ä¹ˆjavaçš„hashmapä¸æ”¯æŒåŠ¨æ€ç¼©å°å®¹é‡ï¼Ÿ - çŸ¥ä¹"></div><div data-desc="è¿™ä¸ªé—®é¢˜è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼ˆå¹¶ä¸æ˜¯ä¸€å¥ç®€å•çš„â€œæ²¡æœ‰å¿…è¦â€èƒ½å›ç­”çš„ï¼‰ã€‚hashmapä¸ºä»€ä¹ˆè¦ç¼©å®¹ï¼š1.ç¨‹åºå‘˜éœ€è¦â€¦"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png&quot;)"></div><div data-hostname="www.zhihu.com"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://www.zhihu.com/question/62923854/answer/204445142?utm_source=wechat_session&amp;utm_medium=social&amp;utm_oi=560497139592011776&amp;utm_content=group3_Answer&amp;utm_campaign=shareopn">javaä¸­çš„HashMapä¸­hashå‡½æ•°ï¼Œåªæ˜¯å•çº¯æ•°å­¦è®¡ç®—å—ï¼Œè¿˜æ˜¯è¿™æ ·è®¾è®¡ç›®å¾—åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ - çŸ¥ä¹</a><div class="info-box"><div class="text-pane"><div data-title="javaä¸­çš„HashMapä¸­hashå‡½æ•°ï¼Œåªæ˜¯å•çº¯æ•°å­¦è®¡ç®—å—ï¼Œè¿˜æ˜¯è¿™æ ·è®¾è®¡ç›®å¾—åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ - çŸ¥ä¹"></div><div data-desc="ä½ çœ‹çš„ä»£ç æ˜¯è€ç‰ˆæœ¬çš„ã€‚ç°åœ¨JDK1.8æœ‰æ–°çš„å®ç°äº†ã€‚é¦–å…ˆä½ åº”è¯¥çŸ¥é“ HashMapé‡Œæœ‰ä¸ªæ•°ç»„ï¼Œå«tableã€‚è€Œé€šè¿‡haâ€¦"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png&quot;)"></div><div data-hostname="www.zhihu.com"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://zhuanlan.zhihu.com/p/396019103">ä»æ³Šæ¾åˆ†å¸ƒè°ˆèµ·HashMapä¸ºä»€ä¹ˆé»˜è®¤æ‰©å®¹å› å­æ˜¯0.75</a><div class="info-box"><div class="text-pane"><div data-title="ä»æ³Šæ¾åˆ†å¸ƒè°ˆèµ·HashMapä¸ºä»€ä¹ˆé»˜è®¤æ‰©å®¹å› å­æ˜¯0.75"></div><div data-desc="å‰ä¸¤å¤©æœ‰äººåœ¨ç¾¤é‡Œé—®äº†ä¸€ä¸ªé—®é¢˜ï¼šHashMapä¸ºä»€ä¹ˆé»˜è®¤æ‰©å®¹å› å­æ˜¯0.75ï¼Ÿã€ 1. æ³Šæ¾åˆ†å¸ƒå…¬å¼ï¼š 2. HashMapæ³Šæ¾åˆ†å¸ƒçš„è§£é‡Šæ¨å¯¼ï¼š* Ideally, under random hashCodes, the frequency of * nodes in bins follows a Poissoâ€¦"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png&quot;)"></div><div data-hostname="zhuanlan.zhihu.com"></div></div></div><div class="preview-pane" style="background-image: url(https://pic1.zhimg.com/v2-045c696e82b854995d6d24e9667bc812_720w.jpg?source=172ae18b)"></div></div></div><h1 class="wolai-block"><span class="inline-wrap">JDK LinkedHashMap<span class="jill"></span>æºç è§£æ</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">LinkedHashMap<span class="jill"></span>æ˜¯å¦‚ä½•è®°ä½æ’å…¥é¡ºåºçš„ï¼Ÿ</span></div></div><h1 class="wolai-block"><span class="inline-wrap">JDK ConcurrentHashMap</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap"><a href="https://www.cnblogs.com/chengxiao/p/6842045.html"><span>ConcurrentHashMap<span class="jill"></span>å®ç°åŸç†åŠæºç åˆ†æ</span></a></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ConcurrentHashMap<span class="jill"></span>ä¸<span class="jill"></span>HashMap<span class="jill"></span>æ±‚ç´¢å¼•æ—¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</span></div></div><div class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>