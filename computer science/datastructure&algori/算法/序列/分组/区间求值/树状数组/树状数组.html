<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../../../../css/wolai.css"/><title>树状数组 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div data-symbol="🙁" class="icon"></div></div><div data-title="树状数组" class="main-title"></div></div></header><article><div class="wolai-block wolai-text"><div><span class="inline-wrap">在讲树状数组前，我们先来了解一个函数。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>lowBit(x)</code></span><span class="inline-wrap">函数，保留</span><span class="inline-wrap"><code>x</code></span><span class="inline-wrap">二进制格式下低位的第一个</span><span class="inline-wrap"><code>1</code></span><span class="inline-wrap">，其它置为</span><span class="inline-wrap"><code>0</code></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">例如</span><span class="inline-wrap"><code>lowBit(11) = 1</code></span><span class="inline-wrap">，</span><span class="inline-wrap"><code>11</code></span><span class="inline-wrap">转化为二进制数就是 </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1011</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(1011)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1011</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">，保留低位第一个</span><span class="inline-wrap"><code>1</code></span><span class="inline-wrap">得</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0001</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(0001)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0001</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">int</span> <span class="token function">lowBit</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> x<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 对于有符号数 -x就是x取反然后加1</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">现在要你设计一种数据结构，初始时给你一个数组</span><span class="inline-wrap"><code>nums</code></span><span class="inline-wrap">，要支持两种操作：</span></div></div><ol class="wolai-block"><li><div class="marker"></div><span class="inline-wrap">修改数组的某个值(单点修改)</span></li><li><div class="marker"></div><span class="inline-wrap">求数组指定区间的和(区间求和)</span></li></ol><hr class="wolai-block"/><div class="wolai-block wolai-text"><div><span class="inline-wrap">对于普通数组而言，</span><span class="inline-wrap"><b>单点修改</b></span><span class="inline-wrap">的时间复杂度是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">，但</span><span class="inline-wrap"><b>区间求和</b></span><span class="inline-wrap">的时间复杂度是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">我们也可以用</span><span class="inline-wrap"><b>前缀和</b></span><span class="inline-wrap">的方法维护这个数组，这样的话</span><span class="inline-wrap"><b>区间求和</b></span><span class="inline-wrap">的时间复杂度就降到了</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>﻿</mtext></mrow><annotation encoding="application/x-tex">O(1)﻿</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord">﻿</span></span></span></span></span><span class="inline-wrap">，但是</span><span class="inline-wrap"><b>单点修改</b></span><span class="inline-wrap">会影响后面所有的元素，时间复杂度是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mtext>﻿</mtext></mrow><annotation encoding="application/x-tex">O(N)﻿</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mord">﻿</span></span></span></span></span><span class="inline-wrap">。</span></div></div><hr class="wolai-block"/><div class="wolai-block wolai-text"><div><span class="inline-wrap">程序最后跑多长时间，是由最慢的一环决定的，因此现在我们希望找到这样一种折中的方法：无论单点修改还是区间查询，它都能不那么慢地完成。</span></div></div><hr class="wolai-block"/><div class="wolai-block wolai-text"><div><span class="inline-wrap">关于数组的维护，有个很自然的想法：可以用一个数组</span><span class="inline-wrap"><code>bit</code></span><span class="inline-wrap">维护若干个小区间(bit<span class="jill"></span>数组的每个元素表示原数组一段区间的和)，单点修改时，</span><span class="inline-wrap"><b>只更新包含这一元素的区间</b></span><span class="inline-wrap">；求前<span class="jill"></span>n<span class="jill"></span>项和时，</span><span class="inline-wrap"><b>通过将区间进行组合，得到从<span class="jill"></span>1<span class="jill"></span>到<span class="jill"></span>n<span class="jill"></span>的区间，然后对所有用到的区间求和</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">问题来了，</span><span class="inline-wrap"><code>bit[i]</code></span><span class="inline-wrap">表示原数组哪段区间的和呢?  树状数组跟原数组存在什么的关系呢?</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre> <span class="token number">1.</span>bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">nums</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span>
 <span class="token number">2.</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> 是 bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span>、bit<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>、bit<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token spread operator">...</span><span class="token punctuation">.</span> <span class="token property-access">的一部分</span>

 根据第<span class="token number">1</span>点<span class="token punctuation">,</span>我们能得出<span class="token operator">:</span>
 nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">nums</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">nums</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token spread operator">...</span> <span class="token operator">+</span> <span class="token function">nums</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
           <span class="token operator">=</span> bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> bit<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> bit<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token spread operator">...</span> <span class="token operator">+</span> bit<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

 根据第<span class="token number">2</span>点<span class="token punctuation">,</span>我们能得出<span class="token operator">:</span>
 修改nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span>时<span class="token punctuation">,</span> bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span>、bit<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>、bit<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token spread operator">...</span> 也要进行对应的修改

 为什么是bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">nums</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token operator">?</span>
 其实<span class="token punctuation">,</span>你想bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span>也可以的<span class="token punctuation">,</span>只是这样bit就变成了前缀和<span class="token punctuation">,</span>也就是区间查询时间复杂度<span class="token constant">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>单点修改时间复杂度<span class="token constant">O</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span>
 或者<span class="token punctuation">,</span>你想Bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">,</span>i<span class="token punctuation">]</span>也可以的<span class="token punctuation">,</span>这样bit就跟原数组没区别了<span class="token punctuation">,</span>也就是区间查询时间复杂度<span class="token constant">O</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">,</span>单点修改时间复杂度<span class="token constant">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
 所以<span class="token punctuation">,</span>bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span>代表哪一段区间<span class="token punctuation">,</span>对这两种操作的时间复杂度具有决定性的影响
 bit<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">nums</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token function">lowBit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span> 就是一种平衡<span class="token punctuation">,</span>能让这两种操作的时间复杂度都维持在<span class="token constant">O</span><span class="token punctuation">(</span>logN<span class="token punctuation">)</span>
</pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">为什么</span><span class="inline-wrap"><code>bit[i] = nums(i-lowBit(i),i]</code></span><span class="inline-wrap">能具有这种魔力?</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token doc-comment comment">/**
 * 树状数组的索引是从1开始的,所以调用方要适当的调整传参
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> BIT <span class="token punctuation">{</span>

     <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bit<span class="token punctuation">;</span>

      <span class="token keyword">public</span> <span class="token function">BIT</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>bit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">add</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>


      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> idx<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> idx <span class="token operator">&lt;</span> bit<span class="token punctuation">.</span>length<span class="token punctuation">;</span> idx <span class="token operator">+=</span> <span class="token function">lowBit</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              bit<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">+=</span> val<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">preSum</span><span class="token punctuation">(</span><span class="token keyword">int</span> idx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> idx <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> idx <span class="token operator">-=</span> <span class="token function">lowBit</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              ans <span class="token operator">+=</span> bit<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">rangeSum</span><span class="token punctuation">(</span><span class="token keyword">int</span> lo<span class="token punctuation">,</span> <span class="token keyword">int</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">preSum</span><span class="token punctuation">(</span>hi<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">preSum</span><span class="token punctuation">(</span>lo <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> idx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">rangeSum</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> idx<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">add</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> val <span class="token operator">-</span> <span class="token function">get</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">lowBit</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> x <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div></div></div><div class="wolai-bookmark wolai-block"><a href="https://zhuanlan.zhihu.com/p/93795692">算法学习笔记(2) : 树状数组</a><div class="info-box"><div class="text-pane"><div data-title="算法学习笔记(2) : 树状数组"></div><div data-desc="树状数组（ Binary Index Tree, BIT）也是很多OIer心中最简洁优美的数据结构之一。最简单的树状数组支持两种操作，时间复杂度均为 O(\log n) ：单点修改：更改数组中一个元素的值区间查询：查询一个区间内所有元素…"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png&quot;)"></div><div data-hostname="zhuanlan.zhihu.com"></div></div></div><div class="preview-pane" style="background-image: url(https://pica.zhimg.com/v2-fbaeb49fdbad31a211fe37f068ca8bb0_720w.jpg?source=172ae18b)"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://halfrost.com/binary_indexed_tree/">聊聊树状数组 Binary Indexed Tree</a><div class="info-box"><div class="text-pane"><div data-title="聊聊树状数组 Binary Indexed Tree"></div><div data-desc="树状数组或二叉索引树（Binary Indexed Tree），又以其发明者命名为 Fenwick 树，最早由 Peter M. Fenwick 于 1994 年以 A New Data Structure for Cumulative Frequency Tables 为题发表在 SOFTWARE PRACTICE AND EXPERIENCE 上。其初衷是解决数据压缩里的累积频率（Cumula"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://halfrost.com/assets/images/apple-touch-icon-152x152.png?v=b322a5b340&quot;)"></div><div data-hostname="halfrost.com"></div></div></div><div class="preview-pane" style="background-image: url(https://img.halfrost.com/2021/04/Blog-99.png)"></div></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><a href="https://leetcode-cn.com/problems/range-sum-query-mutable/"><span>307. 区域和检索 - 数组可修改</span></a></span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">class</span> <span class="token class-name">NumArray</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">BIT</span> bit<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">NumArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BIT</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>nums <span class="token operator">=</span> nums<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        bit<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> val <span class="token operator">-</span> nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">sumRange</span><span class="token punctuation">(</span><span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bit<span class="token punctuation">.</span><span class="token function">rangeSum</span><span class="token punctuation">(</span>left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span></pre></div></code-block></details></article><footer></footer></body></html>