<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>目标文件 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="目标文件" class="main-title"></div></div></header><article><h2 class="wolai-block"><span class="inline-wrap">简介</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>目标文件</b></span><span class="inline-wrap">（</span><span class="inline-wrap"><b>object file</b></span><span class="inline-wrap">）存放</span><span class="inline-wrap"><b>目标代码</b></span><span class="inline-wrap">的计算机文件，它常被称作</span><span class="inline-wrap"><a href="https://zh.wikipedia.org/wiki/二进制文件"><span>二进制文件</span></a></span><span class="inline-wrap">（binaries）。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>目标代码</b></span><span class="inline-wrap">（</span><span class="inline-wrap"><b>object code</b></span><span class="inline-wrap">）</span><span class="inline-wrap"><a href="https://zh.wikipedia.org/wiki/编译器"><span>编译器</span></a></span><span class="inline-wrap">或</span><span class="inline-wrap"><a href="https://zh.wikipedia.org/wiki/汇编器"><span>汇编器</span></a></span><span class="inline-wrap">处理</span><span class="inline-wrap"><a href="https://zh.wikipedia.org/wiki/源代码"><span>源代码</span></a></span><span class="inline-wrap">后所生成的代码，它一般由</span><span class="inline-wrap"><a href="https://zh.wikipedia.org/wiki/机器代码"><span>机器代码</span></a></span><span class="inline-wrap">或接近于机器语言的代码组成。相同的目标代码可以被封装成不同的目标文件。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>目标文件的分类</b></span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">可重定位目标文件：包含二进制代码和数据，可以在编译时与其他可重定位目标文件合并起来，创建一个可执行目标文件。</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">可执行目标文件：包含二进制代码和数据，可以被直接复制到内存并执行。</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">共享目标文件：一种特殊类型的可重定位目标文件，可以在加载或者运行时被动态地加载进内存并链接。</span></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>编译器和汇编器生成可重定位目标文件（包括共享目标文件），链接器生成可执行目标文件。</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">不同操作系统的目标文件格式都不相同，Windows<span class="jill"></span>使用可移植可执行（Portable Executable PE）格式，Linux<span class="jill"></span>系统使用可执行可链接格式（Excutable and Linkable Format ELF），虽然格式不同，但是基本的概念是相似的。</span></div></div><h2 class="wolai-block"><span class="inline-wrap">ELF<span class="jill"></span>文件结构</span></h2><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="media/elf-file-format.jpg" style="width: 100%"/></figure></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">如上图所示，ELF<span class="jill"></span>文件的基本结构，主要由四部分组成：</span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">ELF<span class="jill"></span>文件头 （ELF Header）</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">程序头部表 （Program Header Table / Program Headers）</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">节（Sections）</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">节头部表（Section Header Table / Section Headers）</span></li></ul><h2 class="wolai-block"><span class="inline-wrap">ELF Header</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">ELF<span class="jill"></span>头以一个<span class="jill"></span>16 字节的序列开始，头部描述了生成该文件的系统的字的大小（word size）和字节顺序（大端/小端），以及帮助链接器处理目标文件的信息。</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 查看ELF头</span>
readelf -h hello.o

ELF Header:
  Magic:   7f <span class="token number">45</span> 4c <span class="token number">46</span> 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64 <span class="token comment"># 字的大小</span>
  Version:                           <span class="token number">1</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span>
  Data:                              <span class="token number">2</span>'s complement, little endian <span class="token comment"># 字节顺序</span>
  OS/ABI:                            UNIX - System V
  ABI Version:                       <span class="token number">0</span>
  Type:                              REL <span class="token punctuation">(</span>Relocatable <span class="token function">file</span><span class="token punctuation">)</span> <span class="token comment"># ELF文件类型 </span>
  <span class="token comment"># ELF文件的CPI平台属性</span>
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1 <span class="token comment"># ELF版本号。一般为常数1</span>
  <span class="token comment"># 入口地址，操作系统在加载完该程序后从这个地址开始执行进程的指令。可重定位指令一般没有入口地址，则该值为0</span>
  Entry point address:               0x0
  Start of program headers:          <span class="token number">0</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>
  <span class="token comment"># Section Header Table 在文件中的偏移</span>
  Start of section headers:          <span class="token number">712</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>
  <span class="token comment"># ELF标志位，用来标识一些ELF文件平台相关的属性。</span>
  Flags:                             0x0
  Size of this header:               <span class="token number">64</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> <span class="token comment"># ELF Header的大小</span>
  Size of program headers:           <span class="token number">0</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Number of program headers:         <span class="token number">0</span>
  Size of section headers:           <span class="token number">64</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> <span class="token comment"># 单个Section Header大小</span>
  Number of section headers:         <span class="token number">13</span> <span class="token comment"># Section Header的数量</span>
  <span class="token comment"># Section Header string table 在 Section Header Table中的索引</span>
  Section header string table index: <span class="token number">12</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">ELF Section Header Table</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">ELF 节头表是一个节头（Section Header）数组。每一个节头都描述了其所对应的节的信息，如节名、节大小、在文件中的偏移、读写权限等。</span><span class="inline-wrap"><b>编译器、链接器、装载器都是通过节头表来定位和访问各个节的属性的。</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 查看节头表</span>
☁  ~  readelf -S hello.o
There are <span class="token number">13</span> section headers, starting at offset 0x2c8:

Section Headers:
  <span class="token punctuation">[</span>Nr<span class="token punctuation">]</span> Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">]</span>                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           <span class="token number">0</span>     <span class="token number">0</span>     <span class="token number">0</span>
  <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">]</span> .text             PROGBITS         0000000000000000  00000040
       0000000000000013  0000000000000000  AX       <span class="token number">0</span>     <span class="token number">0</span>     <span class="token number">1</span>
  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
Key to Flags:
  W <span class="token punctuation">(</span>write<span class="token punctuation">)</span>, A <span class="token punctuation">(</span>alloc<span class="token punctuation">)</span>, X <span class="token punctuation">(</span>execute<span class="token punctuation">)</span>, M <span class="token punctuation">(</span>merge<span class="token punctuation">)</span>, S <span class="token punctuation">(</span>strings<span class="token punctuation">)</span>, I <span class="token punctuation">(</span>info<span class="token punctuation">)</span>,
  L <span class="token punctuation">(</span>link order<span class="token punctuation">)</span>, O <span class="token punctuation">(</span>extra OS processing required<span class="token punctuation">)</span>, G <span class="token punctuation">(</span>group<span class="token punctuation">)</span>, T <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span>,
  C <span class="token punctuation">(</span>compressed<span class="token punctuation">)</span>, x <span class="token punctuation">(</span>unknown<span class="token punctuation">)</span>, o <span class="token punctuation">(</span>OS specific<span class="token punctuation">)</span>, E <span class="token punctuation">(</span>exclude<span class="token punctuation">)</span>,
  l <span class="token punctuation">(</span>large<span class="token punctuation">)</span>, p <span class="token punctuation">(</span>processor specific<span class="token punctuation">)</span>

<span class="token comment"># Name(节名) 是一个字符串，保存在一个名为.shstrtab的字符串表</span>
<span class="token comment"># Type(节类型) 节名是一个字符串，但它并不能真正地表示节的类型。对于编译器和链接器来说，主要决定节的属性是节的类型（Type）和节的标志位（Flags）</span>
<span class="token comment"># Address(节地址) 如果该节可以被加载，则Address为该节被加载后在进程地址空间中的虚拟地址，否则Address为0</span>
<span class="token comment"># Offset(节偏移) 如果该节存在于文件中，则表示该节在文件中的偏移；否则无意义，如Offset对于BSS节来说是没有意义的</span>
<span class="token comment"># Size(节大小) </span>
<span class="token comment"># EntSize(节项大小) 有些节包含了一些固定大小的项，如符号表，其包含的每个符号所在的大小都一样的，对于这种节，EntSize表示每个项的大小。如果为0，则表示该节不包含固定大小的项</span>
<span class="token comment"># Flags(节标志位) 表示该节在进程虚拟地址空间中的属性。如是否可写、是否可执行等。</span>
<span class="token comment"># Link  Info(节链接信息) 如果节的类型与链接无关，则这两个成员没有意义</span>
<span class="token comment"># Align(节地址对齐方式) </span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">ELF Section</span></h2><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="media/different-elf-type.jpg" style="width: 100%"/></figure></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.text</code></span><span class="inline-wrap">节是保存了程序代码指令的</span><span class="inline-wrap"><b>代码节</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.rodata</code></span><span class="inline-wrap">节保存了只读的数据，如一行<span class="jill"></span>C<span class="jill"></span>语言代码中的字符串。由于</span><span class="inline-wrap"><code>.rodata</code></span><span class="inline-wrap">节是只读的，所以只能存在于一个可执行文件的</span><span class="inline-wrap"><b>只读段</b></span><span class="inline-wrap">中。因此，只能在</span><span class="inline-wrap"><code>text</code></span><span class="inline-wrap">段（不是</span><span class="inline-wrap"><code>data</code></span><span class="inline-wrap">段）中找到</span><span class="inline-wrap"><code>.rodata</code></span><span class="inline-wrap">节。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>注意：段（</b></span><span class="inline-wrap"><b><code>Segment</code></b></span><span class="inline-wrap"><b>）与节（</b></span><span class="inline-wrap"><b><code>Section</code></b></span><span class="inline-wrap"><b>）的区别。很多地方对两者有所混淆。段是程序执行的必要组成，当多个目标文件链接成一个可执行文件时，会将相同权限的节合并到一个段中。相比而言，节的粒度更小。</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.plt</code></span><span class="inline-wrap">节也称为</span><span class="inline-wrap"><b>过程链接表（Procedure Linkage Table）</b></span><span class="inline-wrap">，</span><span class="inline-wrap"><b>其包含了动态链接器调用从共享库导入的函数所必需的相关代码</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.data</code></span><span class="inline-wrap">节存在于</span><span class="inline-wrap"><code>data</code></span><span class="inline-wrap">段中，</span><span class="inline-wrap"><b>其保存了初始化的全局变量等数据</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.bss</code></span><span class="inline-wrap">节存在于</span><span class="inline-wrap"><code>data</code></span><span class="inline-wrap">段中，占用空间不超过<span class="jill"></span>4<span class="jill"></span>字节，仅表示这个节本省的空间。</span><span class="inline-wrap"><b><code>.bss</code></b></span><span class="inline-wrap"><b>节保存了未进行初始化的全局数据</b></span><span class="inline-wrap">。程序加载时数据被初始化为<span class="jill"></span>0，在程序执行期间可以进行赋值。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.got</code></span><span class="inline-wrap">节保存了</span><span class="inline-wrap"><b>全局偏移表</b></span><span class="inline-wrap">。</span><span class="inline-wrap"><b><code>.got</code></b></span><span class="inline-wrap"><b>节和</b></span><span class="inline-wrap"><b><code>.plt</code></b></span><span class="inline-wrap"><b>节一起提供了对导入的共享库函数的访问入口，由动态链接器在运行时进行修改</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">节保存在</span><span class="inline-wrap"><code>text</code></span><span class="inline-wrap">段中。</span><span class="inline-wrap"><b>其保存了从共享库导入的动态符号表</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.dynstr</code></span><span class="inline-wrap">保存了动态链接字符串表，表中存放了一系列字符串，这些字符串代表了符号名称，以空字符作为终止符。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.rel</code></span><span class="inline-wrap">节保存了重定位相关的信息，</span><span class="inline-wrap"><b>这些信息描述了如何在链接或运行时，对<span class="jill"></span>ELF<span class="jill"></span>目标文件的某部分或者进程镜像进行补充或修改</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.hash</code></span><span class="inline-wrap">节也称为</span><span class="inline-wrap"><code>.gnu.hash</code></span><span class="inline-wrap">，其保存了一个用于查找符号的散列表。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">节是一个</span><span class="inline-wrap"><code>ElfN_Sym</code></span><span class="inline-wrap">的数组，保存了符号信息。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.strtab</code></span><span class="inline-wrap">节保存的是符号字符串表，表中的内容会被</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">的</span><span class="inline-wrap"><code>ElfN_Sym</code></span><span class="inline-wrap">结构中的</span><span class="inline-wrap"><code>st_name</code></span><span class="inline-wrap">引用。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.ctors</code></span><span class="inline-wrap">（</span><span class="inline-wrap"><b>构造器</b></span><span class="inline-wrap">）节和</span><span class="inline-wrap"><code>.dtors</code></span><span class="inline-wrap">（</span><span class="inline-wrap"><b>析构器</b></span><span class="inline-wrap">）节分别保存了指向构造函数和析构函数的函数指针，</span><span class="inline-wrap"><b>构造函数是在<span class="jill"></span>main<span class="jill"></span>函数执行之前需要执行的代码；析构函数是在<span class="jill"></span>main<span class="jill"></span>函数之后需要执行的代码</b></span><span class="inline-wrap">。</span></div></div><h3 class="wolai-block"><span class="inline-wrap">符号表</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">节和</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">节，两者都是符号表。那么它们到底有什么区别呢？存在什么关系呢？</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>符号是对某些类型的数据或代码（如全局变量或函数）的符号引用，函数名或变量名就是符号名</b></span><span class="inline-wrap">。例如，</span><span class="inline-wrap"><code>printf()</code></span><span class="inline-wrap">函数会在动态链接符号表</span><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">中存有一个指向该函数的符号项（以</span><span class="inline-wrap"><code>Elf_Sym</code></span><span class="inline-wrap">数据结构表示）。在大多数共享库和动态链接可执行文件中，存在两个符号表。即</span><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">和</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b><code>.dynsym</code></b></span><span class="inline-wrap"><b>保存了引用来自外部文件符号的全局符号</b></span><span class="inline-wrap">。如</span><span class="inline-wrap"><code>printf</code></span><span class="inline-wrap">库函数。</span><span class="inline-wrap"><b><code>.dynsym</code></b></span><span class="inline-wrap"><b>保存的符号是</b></span><span class="inline-wrap"><b><code>.symtab</code></b></span><span class="inline-wrap"><b>所保存符号的子集，</b></span><span class="inline-wrap"><b><code>.symtab</code></b></span><span class="inline-wrap"><b>中还保存了可执行文件的本地符号</b></span><span class="inline-wrap">。如全局变量，代码中定义的本地函数等。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">既然</span><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">是</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">的子集，那为何要同时存在两个符号表呢？</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">通过</span><span class="inline-wrap"><code>readelf -S</code></span><span class="inline-wrap">命令查看可执行文件的输出，</span><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">标志位是</span><span class="inline-wrap"><code>ALLOC</code></span><span class="inline-wrap">，而</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">则没有标记。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>ALLOC</code></span><span class="inline-wrap">表示有该标记的节会在运行时分配并装载进入内存，而</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">不是在运行时必需的，因此不会被装载到内存中。</span><span class="inline-wrap"><b><code>.dynsym</code></b></span><span class="inline-wrap"><b>保存的符号只能在运行时被解析，因此是运行时动态链接器所需的唯一符号</b></span><span class="inline-wrap">。</span><span class="inline-wrap"><code>.dynsym</code></span><span class="inline-wrap">对于动态链接可执行文件的执行是必需的，而</span><span class="inline-wrap"><code>.symtab</code></span><span class="inline-wrap">只是用来进行调试和链接的。</span></div></div></article><footer></footer></body></html>