<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../../css/wolai.css"/><title>字符串 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="字符串" class="main-title"></div></div></header><article><h3 class="wolai-block"><span class="inline-wrap"><a href="https://leetcode-cn.com/problems/implement-strstr/"><span>子字符串查找</span></a></span></h3><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">暴力解法</span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">strStr</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token class-name">String</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> p<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
            j<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            i <span class="token operator">=</span> i <span class="token operator">-</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i <span class="token operator">-</span> j<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">暴力解法的问题在于需要对文本串的索引进行回退，但实际上我们可以适当调整模式串的索引，从而避免文本串索引的回退。那么我们要怎么调整模式串的索引呢？</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">例如</span></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">            </span><span class="inline-wrap"><code>_ _ _ _ _ i</code></span></div></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">文本串 t : </span><span class="inline-wrap"><code>a b b a b b a b c</code></span></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">             </span><span class="inline-wrap"><code>_ _ _ _ _ j</code></span></div></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">模式串 p : </span><span class="inline-wrap"><code>a b b a b c</code></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">模式串匹配到字符</span><span class="inline-wrap"><code>c</code></span><span class="inline-wrap">（j=5）时发现匹配不上，这时候我们要怎么调整<span class="jill"></span>j<span class="jill"></span>的值呢？</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">获取<span class="jill"></span>p[0,4] -&gt; </span><span class="inline-wrap"><code>a b b a b</code></span><span class="inline-wrap"> 的</span><span class="inline-wrap"><b>最长匹配前后缀</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">所谓前后缀最长匹配就是字符串的前缀和后缀相同，并且相同部分长度最大</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>abbab</code></span><span class="inline-wrap">的前缀有：a , ab , abb , abba</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>abbab</code></span><span class="inline-wrap">的后缀有：b , ab , bab , bbab</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">可以看出前后缀匹配只有<span class="jill"></span>ab，所以前后缀最长匹配是<span class="jill"></span>2，也就是我们只需要把<span class="jill"></span>j=2<span class="jill"></span>即可</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">索引<span class="jill"></span>i<span class="jill"></span>不变，拿此时索引<span class="jill"></span>j<span class="jill"></span>的值跟索引<span class="jill"></span>i<span class="jill"></span>的值做判断</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">// todo 画图</span></div></div></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">KMP</span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">KMP<span class="jill"></span>的本质，解析匹配串，算出前后缀最长匹配数组，当前文本串和模式串匹配失败时，文本串索引不变，模式串索引变为上一个子串的前后缀最长匹配的长度</span></div></div><aside class="bg-cultured wolai-block"><div data-symbol="🔥" class="icon"></div><span class="inline-wrap"><code>next[i]</code></span><span class="inline-wrap"> : </span><span class="inline-wrap"><code>p[0,i]</code></span><span class="inline-wrap">的前后缀最长匹配的长度</span></aside><aside class="bg-cultured wolai-block"><div data-symbol="🔥" class="icon"></div><span class="inline-wrap">当</span><span class="inline-wrap"><code>str[i] ≠ p[j]</code></span><span class="inline-wrap">时，让<span class="jill"></span>j=p[0,j-1]的</span><span class="inline-wrap">最长匹配</span><span class="inline-wrap">前后缀的长度，也就是</span><span class="inline-wrap"><code>j=next[j-1]</code></span></aside><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">strStr</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token class-name">String</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token function">getNext</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> p<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            j <span class="token operator">=</span> next<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">==</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token operator">-</span>j<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getNext</span><span class="token punctuation">(</span><span class="token class-name">String</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// next[i] : p[0:i]的最长匹配前后缀的长度</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果相等，则J往前一步，更新next数组的i位置为j</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> p<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// j是前缀最后一个字符的索引，j+1才是p[0:i]的最长匹配前后缀的长度</span>
            next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 模式串的第一个字符都不匹配,没办法,下一个吧</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 回退 !!!! 注意是p[0,j-1]的最长公共前缀</span>
            j <span class="token operator">=</span> next<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap">Boyer-Moore</span></summary></details><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap">Rabin-Karp</span></summary></details><div class="wolai-block wolai-text"><div><span class="inline-wrap">我们已经讨论过的各种子字符串查找算法。尽管常常出现多个算法都能完成相同的任务的情况，但它们都各有特点：暴力查找算法的实现非常简单且在一般的情况下都工作良好；（Java<span class="jill"></span>的<span class="jill"></span>String<span class="jill"></span>类型的<span class="jill"></span>indexOf()方法使用的就是暴力子字符串查找算法。）Knuth-Morris-Pratt<span class="jill"></span>算法能够保证线性级别的性能且不需要在正文中回退；Boyer-Moore<span class="jill"></span>算法的性能在一般情况下都是亚线性级别（可能是线性级别的<span class="jill"></span>M<span class="jill"></span>倍）; Rabin-Karp<span class="jill"></span>算法是线性级别。每种算法也各有缺点：暴力查找算法所需的时间可能和<span class="jill"></span>MN<span class="jill"></span>成正比；Knuth-Morris-Pratt<span class="jill"></span>算法和<span class="jill"></span>Boyer-Moore<span class="jill"></span>算法都需要额外的内存空间；Rabin-Karp<span class="jill"></span>算法的内循环很长（若干次算术运算，而其他算法都只需要比较字符）</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><a href="https://leetcode-cn.com/problems/longest-word-in-dictionary-through-deleting/"><span>通过删除字母匹配到字典里最长单词</span></a></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><aside class="bg-cultured wolai-block"><div data-symbol="💥" class="icon"></div><span class="inline-wrap">注意区分：最长公共子序列</span><span class="inline-wrap">、最长公共子数组</span><span class="inline-wrap">、p<span class="jill"></span>是否是<span class="jill"></span>str<span class="jill"></span>的子序列</span></aside><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h4 class="wolai-block"><span class="inline-wrap"><a href="https://leetcode-cn.com/problems/longest-duplicate-substring/"><span>1044. 最长重复子串</span></a></span></h4><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h2 class="wolai-block"><span class="inline-wrap">字符串哈希</span></h2><div class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="%E5%9B%9E%E6%96%87/%E5%9B%9E%E6%96%87.html"><span>回文</span></a></div><div class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB.html"><span>编辑距离</span></a></div><div class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="%E4%B8%AD%E5%9C%BA%E6%80%BB%E7%BB%93/%E4%B8%AD%E5%9C%BA%E6%80%BB%E7%BB%93.html"><span>中场总结</span></a></div></article><footer></footer></body></html>