<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/wolai.css"/><title>海量数据 - wolai 笔记</title><link rel="shortcut icon"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="海量数据" class="main-title"></div></div></header><article><div class="wolai-bookmark wolai-block"><a href="https://wizardforcel.gitbooks.io/the-art-of-programming-by-july/content/ch6.html">第六章 海量数据处理 | 编程之法：面试和算法心得</a><div class="info-box"><div class="text-pane"><div data-title="第六章 海量数据处理 | 编程之法：面试和算法心得"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://wizardforcel.gitbooks.io/the-art-of-programming-by-july/content/gitbook/images/apple-touch-icon-precomposed-152.png&quot;)"></div><div data-hostname="wizardforcel.gitbooks.io"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://wangpengcheng.github.io/2019/12/17/hailiangshuju_problems/">面试海量数据问题 - 破戒僧的个人博客 | BY Blog</a><div class="info-box"><div class="text-pane"><div data-title="面试海量数据问题 - 破戒僧的个人博客 | BY Blog"></div><div data-desc="Leaning and function with your new object."></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://wangpengcheng.github.io/img/apple-touch-icon.png&quot;)"></div><div data-hostname="wangpengcheng.github.io"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h2 class="wolai-block"><span class="inline-wrap">蓄水池算法</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">问题：如何随机从<span class="jill"></span>n<span class="jill"></span>个对象中选择一个对象，这<span class="jill"></span>n<span class="jill"></span>个对象是按序排列的，但是在此之前你是不知道<span class="jill"></span>n<span class="jill"></span>的值的。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">思路：如果我们知道<span class="jill"></span>n<span class="jill"></span>的值，那么问题就可以简单的用一个大随机数<span class="jill"></span>rand()%n<span class="jill"></span>得到一个确切的随机位置，那么该位置的对象就是所求的对象，选中的概率是<span class="jill"></span>1/n。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">但现在我们并不知道<span class="jill"></span>n<span class="jill"></span>的值，这个问题便抽象为蓄水池抽样问题，即从一个包含<span class="jill"></span>n<span class="jill"></span>个对象的列表<span class="jill"></span>S<span class="jill"></span>中随机选取<span class="jill"></span>k<span class="jill"></span>个对象，n<span class="jill"></span>为一个非常大或者不知道的值。通常情况下，n<span class="jill"></span>是一个非常大的值，大到无法一次性把所有列表<span class="jill"></span>S<span class="jill"></span>中的对象都放到内存中。我们这个问题是蓄水池抽样问题的一个特例，即<span class="jill"></span>k=1。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">解法：我们总是选择第一个对象，以<span class="jill"></span>1/2<span class="jill"></span>的概率选择第二个，以<span class="jill"></span>1/3<span class="jill"></span>的概率选择第三个，以此类推，以<span class="jill"></span>1/m<span class="jill"></span>的概率选择第<span class="jill"></span>m<span class="jill"></span>个对象。当该过程结束时，每一个对象具有相同的选中概率，即<span class="jill"></span>1/n，证明如下。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">证明：第<span class="jill"></span>m<span class="jill"></span>个对象最终被选中的概率<span class="jill"></span>P=选择<span class="jill"></span>m<span class="jill"></span>的概率*其后面所有对象不被选择的概率，即</span></div></div><div class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo stretchy="false">(</mo><mfrac><mi>m</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mfrac><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></mfrac><mfrac><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow><mrow><mi>m</mi><mo>+</mo><mn>3</mn></mrow></mfrac><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>n</mi></mfrac><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">P=\frac{1}{m}(\frac{m}{m+1}\frac{m+1}{m+2}\frac{m+2}{m+3}...\frac{n-1}{n})=\frac{1}{n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">...</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>Leetcode<span class="jill"></span>题目</b></span></div></div><div class="wolai-bookmark wolai-block"><a href="https://leetcode.com/problems/random-pick-index/">Loading...</a><div class="info-box"><div class="text-pane"><div data-title="Loading..."></div><div data-desc="Level up your coding skills and quickly land a job. This is the best place to expand your knowledge and get prepared for your next interview."></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://leetcode.com/favicon-192x192.png&quot;)"></div><div data-hostname="leetcode.com"></div></div></div><div class="preview-pane" style="background-image: url(https://leetcode.com/static/images/LeetCode_Sharing.png)"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://leetcode.com/problems/linked-list-random-node/">Loading...</a><div class="info-box"><div class="text-pane"><div data-title="Loading..."></div><div data-desc="Level up your coding skills and quickly land a job. This is the best place to expand your knowledge and get prepared for your next interview."></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://leetcode.com/favicon-192x192.png&quot;)"></div><div data-hostname="leetcode.com"></div></div></div><div class="preview-pane" style="background-image: url(https://leetcode.com/static/images/LeetCode_Sharing.png)"></div></div></div><div class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>