<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/wolai.css"/><title>1.IO - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="1.IO" class="main-title"></div></div></header><article><h1 class="wolai-block"><span class="inline-wrap">1.Java IO 概述</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">程序的主要任务是操纵数据，在运行时，这些数据都必须位于内存中，并且属于特定的类型，这样程序才能处理它们。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">本章介绍如何从数据源中读取数据供程序使用，以及如何把程序处理后的数据写到数据目的地。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java.io<span class="jill"></span>包是<span class="jill"></span>java<span class="jill"></span>提供的用于处理程序输入输出的类库。</span></div></div><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="https://github.com/huangdaren1997/pictures/blob/master/JavaIO%E4%BD%93%E7%B3%BB.png?raw=true" style="width: 760px"/></figure></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>节点流与处理流：</b></span><span class="inline-wrap">按照流是否直接与特定的地方(如磁盘、内存、设备等)相连，分为节点流和处理流两类。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>节点流</b></span><span class="inline-wrap">：可以从或向一个特定的地方(节点)读写数据</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>处理流</b></span><span class="inline-wrap">：对一个已存在的流的连接和封装，通过所封装的流的功能调用实现数据读写</span></div></div><hr class="wolai-block"/><h1 class="wolai-block"><span class="inline-wrap">2.字节流概述</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">在字节流中，数据是以字节的形式展现的。字节流分为字节输入流(</span><span class="inline-wrap"><b>InputStream</b></span><span class="inline-wrap">)、字节输出流(</span><span class="inline-wrap"><b>OutputStream</b></span><span class="inline-wrap">)，这两者都是</span><span class="inline-wrap"><b>抽象类</b></span><span class="inline-wrap">，无法被实例化。</span></div></div><h2 class="wolai-block"><span class="inline-wrap">InputStream</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从数据源读取下一个字节（Byte），如果到结尾则返回-1</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从数据源读取若干字节，把它们保存到数组中，如果到结尾则返回-1</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从数组下标off开始存储读取到的数据</span>

<span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭输入流</span>
<span class="token keyword">int</span> <span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回从输入流中读取的字节数目。</span>
<span class="token keyword">void</span> <span class="token function">skip</span><span class="token punctuation">(</span><span class="token keyword">long</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从输入流中跳过参数n指定数目的字节</span>

<span class="token comment">// 从流中重复读入数据</span>
<span class="token keyword">boolean</span> <span class="token function">markSupported</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 判断是否支持重复读入数据</span>
<span class="token keyword">void</span> <span class="token function">mark</span><span class="token punctuation">(</span><span class="token keyword">int</span> readLimit<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从当前位置做标志，直到readLimit，调用read()读取该范围内的数据</span>
<span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//回到做标记的地方，从而实现重复读取</span>
</pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">OutputStream</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">wirte</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 只有那些具有缓冲区的子类才重写了该方法</span></pre></div></code-block><h1 class="wolai-block"><span class="inline-wrap">3.字节流的子类</span></h1><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="https://raw.githubusercontent.com/huangdaren1997/pictures/master/%E5%AD%97%E8%8A%82%E6%B5%81.png" style="width: 760px"/></figure></div><hr class="wolai-block"/><h2 class="wolai-block"><span class="inline-wrap">字节数组输入流与字节数组输出流</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>ByteArrayInputStream 字节数组输入流</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">从内存中的<span class="jill"></span>byte<span class="jill"></span>数组中读取数据。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造方法</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">,</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>ByteArrayOutpuStream<span class="jill"></span>字节数组输出流</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">把数组写入到内存中的<span class="jill"></span>byte<span class="jill"></span>数组,这个类内部会创建一个<span class="jill"></span>byte<span class="jill"></span>数组来存储数据。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造方法</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>例子</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">下面我们通过一个例子来感受了这两个类，我们把字符串写进字节数组，再从字节数组获取字符串内容。</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
   <span class="token comment">// OutputStream</span>
   <span class="token class-name">String</span> text <span class="token operator">=</span> <span class="token string">"Hello World"</span><span class="token punctuation">;</span>
   <span class="token class-name">ByteArrayOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 把text的内容写入ByteArrayOutputStream内部的byte数组中</span>
   out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 获取ByteArrayOutputStream内部的byte数组中的内容</span>
   <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> byteArray <span class="token operator">=</span> out<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// InputStream</span>
   <span class="token class-name">ByteArrayInputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>byteArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> len <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
   in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>
   in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>byte<span class="jill"></span>与<span class="jill"></span>int<span class="jill"></span>之间的转换</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">十进制<span class="jill"></span>15，转换成<span class="jill"></span>byte<span class="jill"></span>是<span class="jill"></span>00001111</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">00001111<span class="jill"></span>转换成<span class="jill"></span>int<span class="jill"></span>是<span class="jill"></span>00000000 00000000 00000000 00001111</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">00000000 00000000 00000000 00001111<span class="jill"></span>转换成十进制还是<span class="jill"></span>15</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">十进制-1，转换成<span class="jill"></span>byte<span class="jill"></span>是<span class="jill"></span>11111111</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">11111111<span class="jill"></span>转换成<span class="jill"></span>int<span class="jill"></span>是<span class="jill"></span>00000000 00000000 00000000 11111111</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">00000000 00000000 00000000 11111111<span class="jill"></span>转换成十进制是<span class="jill"></span>255</span></div></div><hr class="wolai-block"/><h2 class="wolai-block"><span class="inline-wrap">文件输入流与文件输出流</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>FIleInputStream 文件输入流</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">从文件中读取数据。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造方法</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// File对象代表文件  仅仅是代表文件，不代表文件里面的内容。</span>
<span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name就是文件的路径</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>FIleOutputStream 文件输出流</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">输出数据到文件</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造方法</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token class-name">File</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> append<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否在数据后写入数据</span>
<span class="token comment">// 如果文件不存在则会创建，如果file和name指向的是一个目录，则会报错</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>例子</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">从文件中读取数据，再把数据写入到另一个文件</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
   <span class="token class-name">String</span> oldFile <span class="token operator">=</span> <span class="token string">"/home/hdr/Desktop/oldFile"</span><span class="token punctuation">;</span>
   <span class="token class-name">String</span> newFile <span class="token operator">=</span> <span class="token string">"/home/hdr/Desktop/newFile"</span><span class="token punctuation">;</span>

   <span class="token class-name">FileInputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>oldFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>newFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> data <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span>data <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      data <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">管道输入流与管道输出流</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">管道输入输出流用于多线程之间传输数据</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>PipedInputStream 管道输入流</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">PipedInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PipedInputStream</span><span class="token punctuation">(</span><span class="token keyword">int</span> pipeSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PipedInputStream</span><span class="token punctuation">(</span><span class="token class-name">PipedOutputStream</span> src<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PipedInputStream</span><span class="token punctuation">(</span><span class="token class-name">PipedOutputStream</span> src<span class="token punctuation">,</span> <span class="token keyword">int</span> pipeSize<span class="token punctuation">)</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>PipedOutputStream 管道输出流</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">PipedOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>；
<span class="token class-name">PipedOutputStream</span><span class="token punctuation">(</span><span class="token class-name">PipedInputStream</span> snk<span class="token punctuation">)</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">对象输入流与对象输出流</span></h2><h2 class="wolai-block"><span class="inline-wrap">顺序输入流</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">SequenceInputStream<span class="jill"></span>可以把几个输入流串联在一起，合并为一个输入流。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">SequenceInputStream</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> a，<span class="token class-name">InputStream</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SequenceInputStream</span><span class="token punctuation">(</span><span class="token class-name">Enumeration</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 可以看出是很老旧的东西了</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">缓冲输入流和缓冲输出流</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>BufferedInputStream</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">利用缓冲区来提高读取数据的效率。先把一批数据读入到缓冲区，接下来调用<span class="jill"></span>read()方法从缓冲区获取数据。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> in<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 需要被装饰的输入流</span>
<span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> in<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 需要被装饰的输入流以及缓冲区的大小</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>BufferedOutputStream</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">利用缓冲区来提高写入数据的效率。先把一批数据写入到缓冲区，接下来调用<span class="jill"></span>write<span class="jill"></span>方法把缓冲区数据写入目的地。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> in<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 需要被装饰的输入流</span>
<span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> in<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 需要被装饰的输入流以及缓冲区的大小</span></pre></div></code-block><hr class="wolai-block"/><h1 class="wolai-block"><span class="inline-wrap">4.字符流概述</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">字符流分为字符输入流（Reader）和字符输出流（Writer），这两者都是抽象类，无法被实例化。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">我们来看看他们具有的方法。</span></div></div><h2 class="wolai-block"><span class="inline-wrap">Reader</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/Reader.html"><span>Java8 Reader<span class="jill"></span>官方文档</span></a></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 读取单个字符</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cbuf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 读取字符到数组</span>
<span class="token keyword">abstract</span> <span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cbuf<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 读取字符到数组的一部分</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span>charBuffer target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从特定的字符缓冲区读取数据</span>

<span class="token keyword">boolean</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span>； <span class="token comment">// 判断是否可以读取数据</span>
<span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> <span class="token function">skip</span><span class="token punctuation">(</span><span class="token keyword">long</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">boolean</span> <span class="token function">markSupported</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">mark</span><span class="token punctuation">(</span><span class="token keyword">int</span> readAheadLimint<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在当前流的位置做标记</span>
<span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">Writer</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/Writer.html"><span>Java8 Writer<span class="jill"></span>官方文档</span></a></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cbuf<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">编码问题</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">说道处理字符，那就不能不提编码问题了。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java<span class="jill"></span>语义采用<span class="jill"></span>Unicode<span class="jill"></span>字符编码。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>获取本地操作系统的默认字符编码</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"file.encoding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 或者</span>
<span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">defaultCharset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">Reader<span class="jill"></span>类能够将输入流中采用其他编码类型的字符转换为<span class="jill"></span>Unicode<span class="jill"></span>字符，然后在内存中为这些<span class="jill"></span>Unicode<span class="jill"></span>字符分配内存。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Writer<span class="jill"></span>类能够将内存中的<span class="jill"></span>Unicode<span class="jill"></span>字符转换为其他编码类型的字符，再写入到输出流中。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">默认情况下，Reader<span class="jill"></span>和<span class="jill"></span>Writer<span class="jill"></span>会在本地平台的字符编码和<span class="jill"></span>Unicode<span class="jill"></span>编码之间进行编码转换。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">如果需要用到其他类型的编码，可以在构造的时候指定编码类型。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><a href="https://www.wolai.com/m8cfMiNTTwSaHV7oPphFgx#m8cfMiNTTwSaHV7oPphFgx" class="wolai-bi-link"><span class="embed-page">字符编码</span></a></span></div></div><h1 class="wolai-block"><span class="inline-wrap">5.字符流的子类</span></h1><div class="wolai-block wolai-center"><figure style="width: 100%"><img src="https://raw.githubusercontent.com/huangdaren1997/pictures/master/%E5%AD%97%E7%AC%A6%E6%B5%81.png" style="width: 759.5px"/></figure></div><h2 class="wolai-block"><span class="inline-wrap">字符数组<span class="jill"></span>Rader<span class="jill"></span>和字符数组<span class="jill"></span>Writer</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>CharArrayReader</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">CharArrayReader</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CharArrayReader</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> offset<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>CharArrayWriter</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>构造器</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">CharArrayWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CharArrayWriter</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialSize<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">缓冲字符<span class="jill"></span>Reader<span class="jill"></span>和缓冲字符<span class="jill"></span>Writer</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>BufferedReader</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token class-name">Reader</span> in<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token class-name">Reader</span> in<span class="token punctuation">,</span> <span class="token keyword">int</span> sz<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>BufferedWriter</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token class-name">Writer</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token class-name">Writer</span> out<span class="token punctuation">,</span> <span class="token keyword">int</span> sz<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">文件<span class="jill"></span>Reader<span class="jill"></span>和文件<span class="jill"></span>Writer</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>FileReader</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token class-name">FileDescriptor</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>FileWriter</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">,</span> <span class="token keyword">boolean</span> append<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token class-name">FileDescriptor</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token keyword">boolean</span> append<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">字符串<span class="jill"></span>Reader<span class="jill"></span>和字符串<span class="jill"></span>Writer</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>StringReader</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">StringReader</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span>；</pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>StringWriter</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>；
<span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialSize<span class="token punctuation">)</span></pre></div></code-block><hr class="wolai-block"/><h1 class="wolai-block"><span class="inline-wrap">5.标准<span class="jill"></span>IO</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">对于某些应用程序，需要在程序运行的整个生命周期中，从同一个数据源读入数据，或者向同一个数据汇输出数据，例如日志信息。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">在<span class="jill"></span>JDK<span class="jill"></span>的<span class="jill"></span>java.lang.System<span class="jill"></span>类中，java<span class="jill"></span>提供了三个静态变量</span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">System.in  InputStream 默认读取键盘输入的内容</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">System.out PrintStream 默认把信息输出到控制台</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">System.err PrintStream 默认把信息输出到控制台</span></li></ul><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
   <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">String</span> data <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span>data <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>data<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"echo:"</span><span class="token operator">+</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      data <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>重定向标准<span class="jill"></span>I/O</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token function">setIn</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> in<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setOut</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setErr</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><hr class="wolai-block"/><h1 class="wolai-block"><span class="inline-wrap">6.RandomAccessFile</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">前面我们讲的<span class="jill"></span>InputStream、OutputStream、Reader、Writer<span class="jill"></span>都是按照数据的先后顺序读写数据的。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">而<span class="jill"></span>RandomAccessFile<span class="jill"></span>具有随机读写的能力，它既可以读取文件内容,也可以向文件输出数据.更重要的是,程序可以直接跳转到文件的任意地方来读写数据.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>操作文件记录指针的方法</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">long</span> <span class="token function">getFilePointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">seek</span><span class="token punctuation">(</span><span class="token keyword">long</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>读取模式</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">创建<span class="jill"></span>RandomAccessFile<span class="jill"></span>对象时,需要指定一个<span class="jill"></span>mode<span class="jill"></span>参数.</span></div></div><div class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 370px"><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>r</b></span></th><th style="width: 370px"><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>只读</b></span></th></tr></thead><tbody><tr><td><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>rw</b></span></td><td><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>可读写,如果文件不存在则创建文件</b></span></td></tr><tr><td><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>rws</b></span></td><td><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>可读写,并且要求文件的内容或元数据的每个更新都同步写入底层存储设备.</b></span><span class="inline-wrap"> （最慢）</span></td></tr><tr><td><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>rwd</b></span></td><td><span class="inline-wrap"><b></b></span><span class="inline-wrap"><b>可读写,并且要求文件内容的每个更新都同步写入底层存储设备.</b></span><span class="inline-wrap"> （慢）</span></td></tr></tbody></table></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>rws flushes the contents of the file and the modification date of the file.</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>rwd flushs the contents of the file, but the modification date might not change until the file is closed.</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>rw only flushes when you tell it to and doesn&#39;t change the modifcation date until you close the file.</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>BTW rwd is much slower for writes than rw, and rws is slower again.</b></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">package</span> <span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestFile</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"C:\\Users\\Administrator\\Desktop\\新区块链.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RandomAccessFile</span> raf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RandomAccessFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token string">"rw"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> hasRead<span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hasRead<span class="token operator">=</span>raf<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    raf<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></pre></div></code-block><h1 class="wolai-block"><span class="inline-wrap">7.对象序列化</span></h1><div class="wolai-block wolai-text"><div><span class="inline-wrap">对象序列化的目的是将对象保存到磁盘上,或允许在网络中直接传输对象.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">对象序列化机制允许把内存中的<span class="jill"></span>Java<span class="jill"></span>对象转换成平台无关的二进制流.</span></div></div><h2 class="wolai-block"><span class="inline-wrap">实现对象的序列化</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">如果需要让某个对象支持序列化机制,则必须让它的类是可序列化的.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">也就是要这个类实现<span class="jill"></span>Serializable(可序列化)</span><span class="inline-wrap"><b>或</b></span><span class="inline-wrap">Externalizable(可外部化)接口</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">有两种方法实现对象的序列化</span></div></div><h3 class="wolai-block"><span class="inline-wrap"><b>序列化</b></span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">步骤:①实现可序列化类 ②用对象流输出对象</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token comment">//实现可序列化类</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

  <span class="token comment">// 不要重写无参构造器</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></pre></div></code-block><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token comment">//用对象流输出对象</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SerializableObject</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"黄大仁"</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">File</span> saveObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"C:\\Users\\Administrator\\Desktop\\persons.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>saveObj<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        saveObj<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token class-name">ObjectOutputStream</span> ops <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>saveObj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ops<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><h3 class="wolai-block"><span class="inline-wrap">反序列化</span></h3><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">package</span> <span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token class-name">File<span class="token punctuation">.</span>Person</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoadPerson</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO Auto-generated method stub</span>
    <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"C:\\Users\\Administrator\\Desktop\\persons.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">)</span> ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></pre></div></code-block><h3 class="wolai-block"><span class="inline-wrap">注意事项:</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">① 可序列化类的父类必要有</span><span class="inline-wrap"><b>无参数构造器</b></span><span class="inline-wrap">或者本身也是个</span><span class="inline-wrap"><b>可序列化类.</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">② 如果对象的实例变量,是个引用类型,那么该引用类型也需要实现可序列化.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">③ 所有保存到磁盘中的对象都有一个序列化编号</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">④ 当程序试图序列化一个对象时,程序将先检查该对象是否已经被序列化过,只有该对象从未在本次虚拟机中被序列化过,系统才会将该对象转换成字节序列并输出.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">⑤ 如果该对象已经序列化过,那么程序会直接输出一个序列化编号.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">⑥ 也就是说,如果对象被序列化后,对象发生了改变,在下一次序列化中,这些改变也不会被记录下来.</span></div></div><h3 class="wolai-block"><span class="inline-wrap">过滤功能</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>我现在用的是<span class="jill"></span>Java8,改天再写,702<span class="jill"></span>页</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java9<span class="jill"></span>新特性.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java9<span class="jill"></span>中,ObjectInputStream<span class="jill"></span>增加了<span class="jill"></span>setObjectInputFilter()和<span class="jill"></span>getObjectInputFilter()两个方法.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">第一个方法用于为对象输入设置过滤器,当程序通过<span class="jill"></span>ObjectInputStream<span class="jill"></span>反序列化对象时.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">过滤器的<span class="jill"></span>checkInput()方法会被自动激发,</span></div></div><h2 class="wolai-block"><span class="inline-wrap">自定义序列化</span></h2><h3 class="wolai-block"><span class="inline-wrap">transient<span class="jill"></span>关键字</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">如果想禁止对某实例变量进行序列化,只需使用<span class="jill"></span>transient<span class="jill"></span>关键字修饰那个实例变量即可.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">当然,这种简单粗暴的方法也有它不好的地方,那就是反序列化后无法得到该变量的真实值.</span></div></div><h3 class="wolai-block"><span class="inline-wrap">自定义序列化</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">要想实现自定义序列化的类,必须提供下面这些方法.</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ObjectOutputSream</span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ObjectInputStream</span> in<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span><span class="token class-name">Class</span> <span class="token class-name">NotFoundException</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readObjectNoDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ObjectStreamException</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">通过重写<span class="jill"></span>writeObject()方法,可以控制哪些实例变量需要序列化,需要如何序列化.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">通过重写<span class="jill"></span>readObject()方法,可以控制哪些实例变量需要反序列化,需要如何反序列化.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">当序列化流不完整时,readObjectNoData()方法可以用来正确地初始化反序列化的对象.</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">transient</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

  <span class="token comment">// 不要重写无参构造器???</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token class-name">ObjectOutputStream</span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    out<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">writeInt</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name">ObjectInputStream</span> in<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
    <span class="token class-name">StringBuffer</span> name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">StringBuffer</span><span class="token punctuation">)</span> in<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">另一种自定义序列化机制</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java<span class="jill"></span>还提供了另一种序列化机制,这种序列化方式完全由程序员决定存储和回复对象数据.</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">要实现这个目标,Java<span class="jill"></span>类需要实现<span class="jill"></span>Externalizable<span class="jill"></span>接口</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">该接口定义了两个方法</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">void</span> <span class="token function">readExternal</span><span class="token punctuation">(</span><span class="token class-name">ObjectInput</span> in<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">writeExternal</span><span class="token punctuation">(</span><span class="token class-name">ObjectOutput</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Externalizable</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

  <span class="token comment">// 必须提供无参数构造器</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">writeExternal</span><span class="token punctuation">(</span><span class="token class-name">ObjectOutput</span> out<span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token class-name">IOException</span>
  <span class="token punctuation">{</span>
    out<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">writeInt</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">readExternal</span><span class="token punctuation">(</span><span class="token class-name">ObjectInput</span> in<span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span>
  <span class="token punctuation">{</span>
    <span class="token class-name">StringBuffer</span> name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">StringBuffer</span><span class="token punctuation">)</span> in<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">两种序列化机制对比</span></h2><div class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 370px"><span class="inline-wrap">实现<span class="jill"></span>serializable<span class="jill"></span>接口</span></th><th style="width: 370px"><span class="inline-wrap">实现<span class="jill"></span>Externalizable<span class="jill"></span>接口</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">系统自动存储必要信息</span></td><td><span class="inline-wrap">自定义存储哪些信息</span></td></tr><tr><td><span class="inline-wrap">Java<span class="jill"></span>内建支持,易于实现</span></td><td><span class="inline-wrap">需要完成两个方法</span></td></tr><tr><td><span class="inline-wrap">性能稍微差,但是方便</span></td><td><span class="inline-wrap">性能好,但是繁琐</span></td></tr></tbody></table></div><h2 class="wolai-block"><span class="inline-wrap">版本</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">根据前面介绍可知,反序列化<span class="jill"></span>Java<span class="jill"></span>对象时必须提供该对象的<span class="jill"></span>class<span class="jill"></span>文件，那么问题来了，</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">随着项目的升级，这个<span class="jill"></span>class<span class="jill"></span>文件也会升级，如何保证两个<span class="jill"></span>class<span class="jill"></span>文件的兼容性?</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Java<span class="jill"></span>序列化机制允许序列化类提供一个 private static final<span class="jill"></span>的 serialVersionUID<span class="jill"></span>值，该值标志该<span class="jill"></span>Java<span class="jill"></span>类的序列化版本。可以通过<span class="jill"></span>bin<span class="jill"></span>文件夹下的<span class="jill"></span>serialver 工具查看某个类的版本号  serialver Person.</span></div></div></article><footer></footer></body></html>