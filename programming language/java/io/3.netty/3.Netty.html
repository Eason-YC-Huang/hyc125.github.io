<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/wolai.css"/><title>3.Netty - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="3.Netty" class="main-title"></div></div></header><article><h2 class="wolai-block"><span class="inline-wrap">Netty<span class="jill"></span>核心理念</span></h2><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Netty<span class="jill"></span>基于<span class="jill"></span>Java<span class="jill"></span>原生<span class="jill"></span>NIO<span class="jill"></span>做了二次封装</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Java<span class="jill"></span>原生<span class="jill"></span>NIO<span class="jill"></span>的核心是<span class="jill"></span>Channel、Buffer、Selector</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Netty<span class="jill"></span>的核心是<span class="jill"></span>Channel、Buffer、EventLoop、Channel、ChannelHandler、ChannelPipeline、ChannelHandlerContext</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Netty<span class="jill"></span>的<span class="jill"></span>Channel、Buffer、EventLoop<span class="jill"></span>分别是对<span class="jill"></span>NIO<span class="jill"></span>的<span class="jill"></span>Channel、Buffer、Selector<span class="jill"></span>的封装</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">一个<span class="jill"></span>EventLoop<span class="jill"></span>就对应一个<span class="jill"></span>Selector，一个或多个<span class="jill"></span>EventLoop<span class="jill"></span>组成一个</span><span class="inline-wrap">EventLoopGroup</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">创建一条<span class="jill"></span>Channel-&gt;为<span class="jill"></span>Channel<span class="jill"></span>创建<span class="jill"></span>ChannelPipeline-&gt;Channel<span class="jill"></span>注册到<span class="jill"></span>EventLoop</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">EventLoop<span class="jill"></span>监听<span class="jill"></span>Channel<span class="jill"></span>事件-&gt;根据事件调用<span class="jill"></span>Channel<span class="jill"></span>对应回调方法-&gt;回调方法中使事件流过<span class="jill"></span>ChannelPipeline</span></li></ul><h2 class="wolai-block"><span class="inline-wrap">Hello World</span></h2><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">编写一个<span class="jill"></span>Echo<span class="jill"></span>服务器</span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EchoServer</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">NioEventLoopGroup</span> boss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">NioEventLoopGroup</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Config the server</span>
            <span class="token class-name">ServerBootstrap</span> serverBootstrap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>boss<span class="token punctuation">,</span> worker<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                    <span class="token comment">// Responsible for ServerSocketChannel</span>
                    <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingHandler</span><span class="token punctuation">(</span><span class="token class-name">LogLevel</span><span class="token punctuation">.</span>INFO<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token comment">// Responsible for SocketChannel</span>
                    <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            ch<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EchoHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Start the server.</span>
            <span class="token class-name">ChannelFuture</span> f <span class="token operator">=</span> serverBootstrap<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Wait until the server socket is closed.</span>
            f<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            boss<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            worker<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EchoHandler</span> <span class="token keyword">extends</span> <span class="token class-name">ChannelInboundHandlerAdapter</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">channelRead</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">Object</span> msg<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">channelReadComplete</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
            ctx<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block></details><h2 class="wolai-block"><span class="inline-wrap">Netty<span class="jill"></span>组件</span></h2><h3 class="wolai-block"><span class="inline-wrap">Channel、ChannelPipeline、ChannelHandlerContext、ChannelHandler、EventLoopGrouup</span></h3><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap">Channel<span class="jill"></span>表示一条连接到<span class="jill"></span>IO<span class="jill"></span>设备的通道</span></summary></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">每新创建一个</span><span class="inline-wrap"><code>Channel</code></span><span class="inline-wrap">都会为其分配一个新的</span><span class="inline-wrap"><code>ChannelPipeline</code></span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">protected</span> <span class="token class-name">AbstractChannel</span><span class="token punctuation">(</span><span class="token class-name">Channel</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
  id <span class="token operator">=</span> <span class="token function">newId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  unsafe <span class="token operator">=</span> <span class="token function">newUnsafe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pipeline <span class="token operator">=</span> <span class="token function">newChannelPipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">本质就是一条由</span><span class="inline-wrap"><code>ChannelHandlerContext</code></span><span class="inline-wrap">组成的链</span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultChannelPipeline</span> <span class="token keyword">implements</span> <span class="token class-name">ChannelPipeline</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">final</span> <span class="token class-name">AbstractChannelHandlerContext</span> head<span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">AbstractChannelHandlerContext</span> tail<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>  </pre></div></code-block></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>ChannelHandlerContext</code></span><span class="inline-wrap">顾名思义存放了</span><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">，每当有</span><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">添加到</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">中时，都会创建</span><span class="inline-wrap"><code>ChannelHandlerContext</code></span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token comment">// DefaultChannelPipeline</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">ChannelPipeline</span> <span class="token function">addFirst</span><span class="token punctuation">(</span><span class="token class-name">EventExecutorGroup</span> group<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">ChannelHandler</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">AbstractChannelHandlerContext</span> newCtx<span class="token punctuation">;</span>
  <span class="token comment">// ... </span>
  newCtx <span class="token operator">=</span> <span class="token function">newContext</span><span class="token punctuation">(</span>group<span class="token punctuation">,</span> name<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">addFirst0</span><span class="token punctuation">(</span>newCtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">通过</span><span class="inline-wrap"><code>ChannelHandlerContext</code></span><span class="inline-wrap">与</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">、</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">上别的</span><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">进行交互</span></summary></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">分为</span><span class="inline-wrap"><code>ChannelInboundHandler</code></span><span class="inline-wrap">和</span><span class="inline-wrap"><code>ChannelOutboundHandler</code></span><span class="inline-wrap">，分别负责数据的入站和出站操作</span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">从一个客户端应用程序的角度来看，如果事件的运动方向是从客户端到服务器端，那么我们称这些事件为出站的，反之则称为入站的。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">从一个服务器端应用程序的角度来看，如果事件的运动方向是从服务器端到客户端，那么我们称这些事件为出站的，反之则称为入站的。</span></div></div><div class="wolai-block wolai-center"><figure><img src="media/netty-channel-channelpipeline-channelhandler.png" style="width: 730.5px"/></figure></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">上图是服务器接收并返回数据的流程，接收的数据经过</span><span class="inline-wrap"><code>ChannelInboundHandler</code></span><span class="inline-wrap">，然后再经过</span><span class="inline-wrap"><code>ChannelOutboundHandler</code></span><span class="inline-wrap">，最后返回到客户端。</span></div></div></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>ChannelHandlerContext</code></span><span class="inline-wrap">有很多的方法，其中一些方法也存在于</span><span class="inline-wrap"><code>Channel</code></span><span class="inline-wrap">和</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">上，但两者是有区别的。</span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">调用</span><span class="inline-wrap"><code>Channel</code></span><span class="inline-wrap">或者</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">上的这些方法，事件将从</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">的头部(入站事件)/尾部(出站事件)开始传递。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">调用</span><span class="inline-wrap"><code>ChannelHandlerContext</code></span><span class="inline-wrap">上的方法，事件将从当前</span><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">开始向左(入站事件)/向右传递(出站事件)。</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="" class="marker"></div><pre>ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EchoHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">上面是新手写<span class="jill"></span>Echo<span class="jill"></span>服务器很容易犯的错误。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">如果你在<span class="jill"></span>EchoHandler<span class="jill"></span>中调用了</span><span class="inline-wrap"><code>ChannelHandlerContext</code></span><span class="inline-wrap">的</span><span class="inline-wrap"><code>write</code></span><span class="inline-wrap">方法，那么客户端是接收不到信息的。因为<span class="jill"></span>write<span class="jill"></span>事件直接往左走了，不会经过</span><span class="inline-wrap"><code>StringEncoder</code></span><span class="inline-wrap">，没有进行字符串编码，导致客户端接收到信息后，解码失败。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">要解决这个问题，有两种方法</span></div></div><ol class="wolai-block"><li><div class="marker"></div><span class="inline-wrap">调用</span><span class="inline-wrap"><code>Channel/ChannelPipeline</code></span><span class="inline-wrap">的</span><span class="inline-wrap"><code>write</code></span><span class="inline-wrap">方法，那么</span><span class="inline-wrap"><code>write</code></span><span class="inline-wrap">事件将从</span><span class="inline-wrap"><code>ChannelPipeline</code></span><span class="inline-wrap">的尾部开始向前传递，这样就会经过</span><span class="inline-wrap"><code>StringEncoder</code></span><span class="inline-wrap">进行编码。（这不是好的方案）</span></li><li><div class="marker"></div><span class="inline-wrap">调整</span><span class="inline-wrap"><code>ChannelHandler</code></span><span class="inline-wrap">的顺序</span><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="" class="marker"></div><pre>ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EchoHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div></code-block></li></ol><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></details><h3 class="wolai-block"><span class="inline-wrap">Bootstrapping</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>Bootstrap</code></span><span class="inline-wrap">提供了启动服务端和客户端以及设置网络配置的功能。</span><span class="inline-wrap"><code>Bootstrap</code></span><span class="inline-wrap">类负责客户端的配置，</span><span class="inline-wrap"><code>ServerBootstrap</code></span><span class="inline-wrap">类负责服务器的配置。</span></div></div><hr class="wolai-block"/><h3 class="wolai-block"><span class="inline-wrap">Codec</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">网络编程的两大难题，连接的生命周期的管理、数据的编解码。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Netty<span class="jill"></span>提供了一系列的</span><span class="inline-wrap"><code>encoder</code></span><span class="inline-wrap">和</span><span class="inline-wrap"><code>decoder</code></span><span class="inline-wrap">方便我们对数据进行编解码。</span></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>解码器</b></span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">将字节解码为消息：</span><span class="inline-wrap"><code>ByteToMessageDecoder</code></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">将一种消息类型解码为另一种消息类型：</span><span class="inline-wrap"><code>MessageToMessageDecoder</code></span></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>ByteToMessageDecoder</b></span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">将字节解码为消息(或者另一个字节序列)是一项如此常见的任务，以至于<span class="jill"></span>Netty<span class="jill"></span>为它提供了一个抽象的基类:ByteToMessageDecoder。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">由于你不可能知道远程节点是否会一次性地发送一个完整的消息，所以这个类会对入站数据进行缓冲，直到它准备好处理。</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token comment">// ByteToMessageDecoder最重要的两个方法</span>

<span class="token comment">// 这是你必须实现的唯一抽象方法。decode()方法被调用时将会传入一个包含了传入数据的ByteBuf，以及一个用来添加解码消息的List。</span>
<span class="token comment">// 对这个方法的调用将会重复进行，直到确定没有新的元素被添加到该List，或者该ByteBuf中没有更多可读取的字节时为止。</span>
<span class="token comment">// 然后，如果该List不为空，那么它的内容将会被传递给ChannelPipeline中的下一个ChannelInboundHandler</span>
<span class="token keyword">void</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">ByteBuf</span> in<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Netty提供的这个默认实现只是简单地调用了decode()方法。 当Channel的状态变为非活动时，这个方法将会被调用一次。 </span>
<span class="token comment">// 可以重写该方法以提供特殊的处理</span>
<span class="token keyword">void</span> <span class="token function">decodeLast</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">ByteBuf</span> in<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> out<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">下面例子展示了如何解码一个由<span class="jill"></span>int<span class="jill"></span>组成的字节流</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToIntegerDecoder</span> <span class="token keyword">extends</span> <span class="token class-name">ByteToMessageDecoder</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">ByteBuf</span> in<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">readableBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>MessageToMessageDecoder</b></span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token comment">// 类型参数 I 指定了 decode()方法的输入参数 msg 的类型</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">MessageToMessageDecoder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">I</span><span class="token punctuation">></span></span> <span class="token keyword">extends</span> <span class="token class-name">ChannelInboundHandlerAdapter</span><span class="token punctuation">{</span>
    <span class="token comment">//...</span>
    <span class="token comment">// 对于每个需要被解码为另一种格式的入站消息来说，该方法都将会被调用。</span>
    <span class="token comment">// 解码消息随后会被传递给ChannelPipeline中的下一个ChannelInboundHandler</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">I</span> msg<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">下面例子展示了一个把<span class="jill"></span>Integer<span class="jill"></span>转换成<span class="jill"></span>String<span class="jill"></span>的解码器</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IntegerToStringDecoder</span> <span class="token keyword">extends</span> <span class="token class-name">MessageToMessageDecoder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">Integer</span> msg<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        out<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block></details></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">编码器</span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">编码器实现了</span><span class="inline-wrap"><code>ChannelOutboundHandler</code></span><span class="inline-wrap">，负责并将出站数据从一种格式转换为另一种格式。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Netty 提供了一组类，用于帮助你编写具有以下功能的编码器：</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">将消息编码为字节：</span><span class="inline-wrap"><code>MessageToByteEncoder</code></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">将消息编码为消息：</span></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>MessageToByteEncoder</b></span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></details><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><b>MessageToMessageEncoder</b></span></summary></details></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">编解码器</span></summary><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><b>ByteToMessageCodec</b></span></summary></details><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><b>MessageToMessageCodec</b></span></summary></details><details class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><b>CombinedChannelDuplexHandler</b></span></summary></details></details><hr class="wolai-block"/><div class="wolai-block wolai-text"><div><span class="inline-wrap"><b>Echo<span class="jill"></span>服务器<span class="jill"></span>2</b></span></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">使用字符串编解码器</span></summary><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token parameter"><span class="token known-class-name class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token maybe-class-name">NioEventLoopGroup</span> boss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token maybe-class-name">NioEventLoopGroup</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Config the server</span>
        <span class="token maybe-class-name">ServerBootstrap</span> serverBootstrap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token method function property-access">group</span><span class="token punctuation">(</span>boss<span class="token punctuation">,</span> worker<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token method function property-access">channel</span><span class="token punctuation">(</span><span class="token maybe-class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token property-access">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token method function property-access">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingHandler</span><span class="token punctuation">(</span><span class="token maybe-class-name">LogLevel</span><span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token method function property-access">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token operator">&lt;</span><span class="token maybe-class-name">SocketChannel</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    @<span class="token maybe-class-name">Override</span>
                    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token parameter"><span class="token maybe-class-name">SocketChannel</span> ch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        ch<span class="token punctuation">.</span><span class="token method function property-access">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EchoHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token maybe-class-name">ChannelFuture</span> f <span class="token operator">=</span> serverBootstrap<span class="token punctuation">.</span><span class="token method function property-access">bind</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token method function property-access">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span><span class="token maybe-class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token method function property-access">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">finally</span> <span class="token punctuation">{</span>
        boss<span class="token punctuation">.</span><span class="token method function property-access">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        worker<span class="token punctuation">.</span><span class="token method function property-access">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EchoHandler</span> <span class="token keyword">extends</span> <span class="token class-name">ChannelDuplexHandler</span> <span class="token punctuation">{</span>
    @<span class="token maybe-class-name">Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">channelRead</span><span class="token punctuation">(</span><span class="token maybe-class-name">ChannelHandlerContext</span> ctx<span class="token punctuation">,</span> <span class="token known-class-name class-name">Object</span> msg<span class="token punctuation">)</span> throws <span class="token maybe-class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token maybe-class-name">System</span><span class="token punctuation">.</span><span class="token property-access">out</span><span class="token punctuation">.</span><span class="token method function property-access">println</span><span class="token punctuation">(</span><span class="token string">"msg from channelRead "</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></pre></div></code-block></details><hr class="wolai-block"/><h3 class="wolai-block"><span class="inline-wrap">Bytebuf</span></h3><hr class="wolai-block"/><h2 class="wolai-block"><span class="inline-wrap">Transports</span></h2><h2 class="wolai-block"><span class="inline-wrap">编写测试</span></h2><hr class="wolai-block"/><h2 class="wolai-block"><span class="inline-wrap">源码阅读</span></h2><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">了解各种核心组件的作用</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Future<span class="jill"></span>的抽象</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">transport<span class="jill"></span>模块(Bootstrap、Channel、EventLoop<span class="jill"></span>的基础)</span><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Channel、ChannelPipeline、ChannelHandler<span class="jill"></span>的各种相似的方法的区别，值得好好斟酌</span></li></ul></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">codec<span class="jill"></span>模块(编解码套件的基础)</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">buffer<span class="jill"></span>模块(Bytebuf<span class="jill"></span>的基础)</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">各种内置的编解码套件和内置<span class="jill"></span>handler</span></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="future/Future.html"><span>Future</span></a></div><div class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="eventloopgroup/EventLoopGroup.html"><span>EventLoopGroup</span></a></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Channel 、 ChannelPipeline 、 ChannelHandler</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">codec</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"></span><br/></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div></div></div><div class="wolai-bookmark wolai-block"><a href="https://blog.csdn.net/zxhoo/article/details/17964353">Netty4学习笔记（9）-- Channel状态转换_zxh的专栏-CSDN博客</a><div class="info-box"><div class="text-pane"><div data-title="Netty4学习笔记（9）-- Channel状态转换_zxh的专栏-CSDN博客"></div><div data-desc="分析NioSocketChannel如何进入open、registered和active状态"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://g.csdnimg.cn/static/logo/favicon32.ico&quot;)"></div><div data-hostname="blog.csdn.net"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://www.cnblogs.com/brandonli/p/10240998.html">netty源码解析(4.0)-13 Channel NIO实现:  关闭和清理 - 自带buff - 博客园</a><div class="info-box"><div class="text-pane"><div data-title="netty源码解析(4.0)-13 Channel NIO实现:  关闭和清理 - 自带buff - 博客园"></div><div data-desc="Channel提供了3个方法用来实现关闭清理功能：disconnect,close,deregister。本章重点分析这个3个方法的功能的NIO实现。 disconnect实现: 断开连接 disco"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://common.cnblogs.com/favicon.svg&quot;)"></div><div data-hostname="www.cnblogs.com"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="bytebuf/Bytebuf.html"><span>Bytebuf</span></a></div></article><footer></footer></body></html>