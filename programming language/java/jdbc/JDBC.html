<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>JDBC - wolai 笔记</title><link rel="shortcut icon"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="JDBC" class="main-title"></div></div></header><article><div class="wolai-block wolai-text"><div><span class="inline-wrap">JDBC<span class="jill"></span>提供了统一的<span class="jill"></span>API<span class="jill"></span>来对数据库进行操作。</span></div></div><h2 class="wolai-block"><span class="inline-wrap">JDBC<span class="jill"></span>基本使用</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">怎么通过<span class="jill"></span>JDBC<span class="jill"></span>获取数据库数据？建立数据库连接，创建<span class="jill"></span>SQL<span class="jill"></span>语句，执行<span class="jill"></span>SQL<span class="jill"></span>语句，获取执行结果</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">Connection</span></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">Typically, a JDBC application connects to a target data source using one of two classes:</span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">有两种方式可以获取数据连接，一种是通过</span><span class="inline-wrap"><code>DriverManager</code></span><span class="inline-wrap">，一种是通过</span><span class="inline-wrap"><code>DataSource</code></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>DriverManager</code></span><span class="inline-wrap">顾名思义管理着一组数据库驱动(</span><span class="inline-wrap"><code>Driver</code></span><span class="inline-wrap">)，通过</span><span class="inline-wrap"><code>Driver</code></span><span class="inline-wrap">可以获取连接，自从<span class="jill"></span>JDBC 4.0<span class="jill"></span>开始，</span><span class="inline-wrap"><code>Driver</code></span><span class="inline-wrap">的实现类在加载时，会自动注册到</span><span class="inline-wrap"><code>DriverManager</code></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap">是<span class="jill"></span>JDBC4.0 新增的接口，官方更推荐使用这个。</span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>DriverManager</code></span><span class="inline-wrap">: This fully implemented class connects an application to a data source, which is specified by a database URL. When this class first attempts to establish a connection, it automatically loads any JDBC 4.0 drivers found within the class path. Note that your application must manually load any JDBC drivers prior to version 4.0.</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap">: This interface is preferred over </span><span class="inline-wrap"><code>DriverManager</code></span><span class="inline-wrap"> because it allows details about the underlying data source to be transparent to your application. A </span><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap"> object&#39;s properties are set so that it represents a particular data source. See </span><span class="inline-wrap"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/sqldatasources.html"><span>Connecting with DataSource Objects</span></a></span><span class="inline-wrap"> for more information. For more information about developing applications with the </span><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap"> class, see the latest </span><span class="inline-wrap"><a href="https://javaee.github.io/tutorial/toc.html"><span><i>The Java EE Tutorial</i></span></a></span><span class="inline-wrap">.</span><div class="wolai-block wolai-text"><div><span class="inline-wrap">DataSource<span class="jill"></span>是如何获取连接的？都是从<span class="jill"></span>Driver<span class="jill"></span>里面获取连接的</span></div></div></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap">总结：</span><span class="inline-wrap"><code>DriverManager</code></span><span class="inline-wrap">管理</span><span class="inline-wrap"><code>Driver</code></span><span class="inline-wrap">，可以直接通过</span><span class="inline-wrap"><code>Driver</code></span><span class="inline-wrap">获取连接，也可以从</span><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap">获取连接，</span><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap">就是对</span><span class="inline-wrap"><code>Driver</code></span><span class="inline-wrap">的封装。</span></div></div><div class="wolai-bookmark wolai-block"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/sqldatasources.html">Connecting with DataSource Objects (The Java™ Tutorials &gt;        
            JDBC Database Access &gt; JDBC Basics)
</a><div class="info-box"><div class="text-pane"><div data-title="Connecting with DataSource Objects (The Java™ Tutorials &gt;        
            JDBC Database Access &gt; JDBC Basics)
"></div><div data-desc="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform tra"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://docs.oracle.com/favicon.ico&quot;)"></div><div data-hostname="docs.oracle.com"></div></div></div><div class="preview-pane"></div></div></div></details><div class="wolai-block wolai-text"><div><span class="inline-wrap">Statement</span></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">There are three different kinds of statements:</span></summary><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>Statement</code></span><span class="inline-wrap">: Used to implement simple SQL statements with no parameters.</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>PreparedStatement</code></span><span class="inline-wrap">: (Extends </span><span class="inline-wrap"><code>Statement</code></span><span class="inline-wrap">.) Used for precompiling SQL statements that might contain input parameters. See </span><span class="inline-wrap"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html"><span>Using Prepared Statements</span></a></span><span class="inline-wrap"> for more information.</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>CallableStatement:</code></span><span class="inline-wrap"> (Extends </span><span class="inline-wrap"><code>PreparedStatement</code></span><span class="inline-wrap">.) Used to execute stored procedures that may contain both input and output parameters. See </span><span class="inline-wrap"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/storedprocedures.html"><span>Stored Procedures</span></a></span><span class="inline-wrap"> for more information.</span></li></ul></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">To execute a query, call an </span><span class="inline-wrap"><code>execute</code></span><span class="inline-wrap"> method from </span><span class="inline-wrap"><code>Statement</code></span><span class="inline-wrap"> such as the following:</span></summary><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>execute</code></span><span class="inline-wrap">: Returns </span><span class="inline-wrap"><code>true</code></span><span class="inline-wrap"> if the first object that the query returns is a </span><span class="inline-wrap"><code>ResultSet</code></span><span class="inline-wrap"> object. Use this method if the query could return one or more </span><span class="inline-wrap"><code>ResultSet</code></span><span class="inline-wrap"> objects. Retrieve the </span><span class="inline-wrap"><code>ResultSet</code></span><span class="inline-wrap"> objects returned from the query by repeatedly calling </span><span class="inline-wrap"><code>Statement.getResultSet</code></span><span class="inline-wrap">.</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>executeQuery</code></span><span class="inline-wrap">: Returns one </span><span class="inline-wrap"><code>ResultSet</code></span><span class="inline-wrap"> object.</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>executeUpdate</code></span><span class="inline-wrap">: Returns an integer representing the number of rows affected by the SQL statement. Use this method if you are using </span><span class="inline-wrap"><code>INSERT</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>DELETE</code></span><span class="inline-wrap">, or </span><span class="inline-wrap"><code>UPDATE</code></span><span class="inline-wrap"> SQL statements.</span></li></ul></details><div class="wolai-block wolai-text"><div><span class="inline-wrap">ResultSet</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>参考文献</b></span></summary><div class="wolai-bookmark wolai-block"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/index.html">Lesson: JDBC Basics (The Java™ Tutorials &gt; JDBC Database Access)</a><div class="info-box"><div class="text-pane"><div data-title="Lesson: JDBC Basics (The Java™ Tutorials &gt; JDBC Database Access)"></div><div data-desc="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform tra"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://docs.oracle.com/favicon.ico&quot;)"></div><div data-hostname="docs.oracle.com"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/processingsqlstatements.html">Processing SQL Statements with JDBC (The Java™ Tutorials &gt;        
            JDBC Database Access &gt; JDBC Basics)
</a><div class="info-box"><div class="text-pane"><div data-title="Processing SQL Statements with JDBC (The Java™ Tutorials &gt;        
            JDBC Database Access &gt; JDBC Basics)
"></div><div data-desc="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform tra"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://docs.oracle.com/favicon.ico&quot;)"></div><div data-hostname="docs.oracle.com"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/retrieving.html">Retrieving and Modifying Values from Result Sets (The Java™ Tutorials &gt;        
            JDBC Database Access &gt; JDBC Basics)
</a><div class="info-box"><div class="text-pane"><div data-title="Retrieving and Modifying Values from Result Sets (The Java™ Tutorials &gt;        
            JDBC Database Access &gt; JDBC Basics)
"></div><div data-desc="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform tra"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://docs.oracle.com/favicon.ico&quot;)"></div><div data-hostname="docs.oracle.com"></div></div></div><div class="preview-pane"></div></div></div></details><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h2 class="wolai-block"><span class="inline-wrap">Hikari JDBC<span class="jill"></span>连接池</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h2 class="wolai-block"><span class="inline-wrap">Spring<span class="jill"></span>整合<span class="jill"></span>JDBC</span></h2><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>Spring Framework</b></span></summary><div class="wolai-block wolai-text"><div><span class="inline-wrap">创建<span class="jill"></span>DataSrouce Bean，整合了<span class="jill"></span>Spring<span class="jill"></span>的<span class="jill"></span>ORM<span class="jill"></span>框架会从容器中获取该<span class="jill"></span>DataSource Bean。</span></div></div></details><details class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><b>Spring Boot</b></span></summary><ol class="wolai-block"><li><div class="marker"></div><span class="inline-wrap">We prefer </span><span class="inline-wrap"><a href="https://github.com/brettwooldridge/HikariCP"><span>HikariCP</span></a></span><span class="inline-wrap"> for its performance and concurrency. If HikariCP is available, we always choose it.</span></li><li><div class="marker"></div><span class="inline-wrap">Otherwise, if the Tomcat pooling </span><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap"> is available, we use it.</span></li><li><div class="marker"></div><span class="inline-wrap">Otherwise, if </span><span class="inline-wrap"><a href="https://commons.apache.org/proper/commons-dbcp/"><span>Commons DBCP2</span></a></span><span class="inline-wrap"> is available, we use it.</span></li><li><div class="marker"></div><span class="inline-wrap">If none of HikariCP, Tomcat, and DBCP2 are available and if Oracle UCP is available, we use it.</span></li></ol><aside class="bg-cultured wolai-block"><div data-symbol="💥" class="icon"></div><span class="inline-wrap">If you use the </span><span class="inline-wrap"><code>spring-boot-starter-jdbc</code></span><span class="inline-wrap"> or </span><span class="inline-wrap"><code>spring-boot-starter-data-jpa</code></span><span class="inline-wrap"> “starters”, you automatically get a dependency to </span><span class="inline-wrap"><code>HikariCP</code></span><span class="inline-wrap">.</span></aside></details><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></article><footer></footer></body></html>