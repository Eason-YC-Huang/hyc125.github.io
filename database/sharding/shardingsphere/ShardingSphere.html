<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>ShardingSphere - wolai ç¬”è®°</title><link rel="shortcut icon" href="media/background_logo_1.png"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon icon-image" style="background-image: url(&quot;media/background_logo.png&quot;)"></div></div><div data-title="ShardingSphere" class="main-title"></div></div></header><article><div class="wolai-bookmark wolai-block"><a href="https://github.com/apache/shardingsphere/issues/650">https://github.com/apache/shardingsphere/issues/650</a><div class="info-box"><div class="text-pane"><div data-title="github.com"></div><div class="icon-host"><div data-hostname="github.com"></div></div></div><div class="preview-pane"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://mp.weixin.qq.com/s/lLct0qY_D82-Wh5zrkzWiQ">åœ¨å®è·µä¸­ä½¿ç”¨ShardingJdbcç»„ä»¶çš„æ­£ç¡®å§¿åŠ¿(ä¸€)</a><div class="info-box"><div class="text-pane"><div data-title="åœ¨å®è·µä¸­ä½¿ç”¨ShardingJdbcç»„ä»¶çš„æ­£ç¡®å§¿åŠ¿(ä¸€)"></div><div data-desc="åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œéœ€è¦æ ¹æ®å®é™…çš„ä¸šåŠ¡æƒ…å†µæ¥é€‰ç”¨åˆé€‚çš„ç»„ä»¶æ„å»ºç³»ç»Ÿ"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;http://res.wx.qq.com/a/wx_fed/assets/res/MjliNWVm.svg&quot;)"></div><div data-hostname="mp.weixin.qq.com"></div></div></div><div class="preview-pane" style="background-image: url(http://mmbiz.qpic.cn/mmbiz_png/AtZHGo2bvzIXvsBdvIy7Z9P5MUvSFumDzE5tMwzv0Zo2CPOtiauyn9v2wTozwDjwL6xoQq31ICb3BJweJzeCTPQ/0?wx_fmt=png)"></div></div></div><div class="wolai-bookmark wolai-block"><a href="https://mp.weixin.qq.com/s/X34qKPAs2aHQTvE_6VStiQ">Sharding-Sphereå®æˆ˜ï¼šå®ç°ç±»å¤šç§Ÿæˆ·åˆ†åº“åˆ†è¡¨</a><div class="info-box"><div class="text-pane"><div data-title="Sharding-Sphereå®æˆ˜ï¼šå®ç°ç±»å¤šç§Ÿæˆ·åˆ†åº“åˆ†è¡¨"></div><div data-desc="æ¥è‡ªæŠ€æœ¯äº¤æµç¾¤æœ‹å‹çš„é—®é¢˜ï¼Œå¦‚ä½•å€ŸåŠ©åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶å®ç°ç±»ä¼¼å¤šç§Ÿæˆ·è®¾è®¡ï¼ï¼ï¼"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;http://res.wx.qq.com/a/wx_fed/assets/res/MjliNWVm.svg&quot;)"></div><div data-hostname="mp.weixin.qq.com"></div></div></div><div class="preview-pane" style="background-image: url(http://mmbiz.qpic.cn/mmbiz_jpg/4o22OFcmzHmmJLXGia6ODEIaFG4uzt86ibhsEVeYGzNN4AZOOqrcyT1TbbIjf2W5NaVWHFgicbibFaibTQqoMEC4PbQ/0?wx_fmt=jpeg)"></div></div></div><h2 class="wolai-block"><span class="inline-wrap">åŸºæœ¬æ¦‚å¿µ</span></h2><h3 class="wolai-block"><span class="inline-wrap">è¡¨çš„æ¦‚å¿µ</span></h3><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">é€»è¾‘è¡¨ï¼šç›¸åŒé€»è¾‘å’Œæ•°æ®ç»“æ„è¡¨çš„æ€»ç§°ã€‚ä¾‹ï¼šè®¢å•æ•°æ®æ ¹æ®ä¸»é”®å°¾æ•°æ‹†åˆ†ä¸º 10 å¼ è¡¨ï¼Œåˆ†åˆ«æ˜¯ </span><span class="inline-wrap"><code>t_order_0</code></span><span class="inline-wrap"> åˆ° </span><span class="inline-wrap"><code>t_order_9</code></span><span class="inline-wrap">ï¼Œä»–ä»¬çš„é€»è¾‘è¡¨åä¸º </span><span class="inline-wrap"><code>t_order</code></span><span class="inline-wrap">ã€‚</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">çœŸå®è¡¨ï¼šåœ¨åˆ†ç‰‡çš„æ•°æ®åº“ä¸­çœŸå®å­˜åœ¨çš„ç‰©ç†è¡¨ã€‚å³ä¸Šä¸ªç¤ºä¾‹ä¸­çš„ </span><span class="inline-wrap"><code>t_order_0</code></span><span class="inline-wrap"> åˆ° </span><span class="inline-wrap"><code>t_order_9</code></span><span class="inline-wrap">ã€‚</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">æ•°æ®èŠ‚ç‚¹ï¼šæ•°æ®åˆ†ç‰‡çš„æœ€å°å•å…ƒã€‚ç”±</span><span class="red inline-wrap">æ•°æ®æºåç§°</span><span class="inline-wrap">å’Œ</span><span class="red inline-wrap">æ•°æ®è¡¨</span><span class="inline-wrap">ç»„æˆï¼Œä¾‹ï¼š</span><span class="inline-wrap"><code>ds_0.t_order_0</code></span><span class="inline-wrap">ã€‚</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">ç»‘å®šè¡¨ï¼šæŒ‡åˆ†ç‰‡è§„åˆ™ä¸€è‡´çš„ä¸»è¡¨å’Œå­è¡¨ã€‚ä¾‹å¦‚ï¼š</span><span class="inline-wrap"><code>t_order</code></span><span class="inline-wrap"> è¡¨å’Œ </span><span class="inline-wrap"><code>t_order_item</code></span><span class="inline-wrap"> è¡¨ï¼Œå‡æŒ‰ç…§ </span><span class="inline-wrap"><code>order_id</code></span><span class="inline-wrap"> åˆ†ç‰‡ï¼Œåˆ™æ­¤ä¸¤å¼ è¡¨äº’ä¸ºç»‘å®šè¡¨å…³ç³»ã€‚ç»‘å®šè¡¨ä¹‹é—´çš„å¤šè¡¨å…³è”æŸ¥è¯¢ä¸ä¼šå‡ºç°ç¬›å¡å°”ç§¯å…³è”ï¼Œå…³è”æŸ¥è¯¢æ•ˆç‡å°†å¤§å¤§æå‡ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œå¦‚æœ SQL ä¸ºï¼š</span><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="SQL" class="marker"></div><pre><span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order o <span class="token keyword">JOIN</span> t_order_item i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">åœ¨ä¸é…ç½®ç»‘å®šè¡¨å…³ç³»æ—¶ï¼Œé‚£ä¹ˆè·¯ç”±åçš„ SQL åº”è¯¥ä¸º 4 æ¡ï¼Œå®ƒä»¬å‘ˆç°ä¸ºç¬›å¡å°”ç§¯ï¼š</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="SQL" class="marker"></div><pre><span class="token comment"># t_order å’Œ t_order_item éƒ½åˆ†äº†ä¸¤å¼ è¡¨</span>
<span class="token comment"># t_order_0ã€t_order_1ã€t_order_item_0ã€t_order_item_1</span>
<span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order_0 o <span class="token keyword">JOIN</span> t_order_item_0 i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order_0 o <span class="token keyword">JOIN</span> t_order_item_1 i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order_1 o <span class="token keyword">JOIN</span> t_order_item_0 i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order_1 o <span class="token keyword">JOIN</span> t_order_item_1 i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">åœ¨é…ç½®ç»‘å®šè¡¨å…³ç³»åï¼Œè·¯ç”±çš„ SQL åº”è¯¥ä¸º 2 æ¡ï¼š</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="SQL" class="marker"></div><pre><span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order_0 o <span class="token keyword">JOIN</span> t_order_item_0 i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> i<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> t_order_1 o <span class="token keyword">JOIN</span> t_order_item_1 i <span class="token keyword">ON</span> o<span class="token punctuation">.</span>order_id<span class="token operator">=</span>i<span class="token punctuation">.</span>order_id <span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>order_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">å…¶ä¸­ </span><span class="inline-wrap"><code>t_order</code></span><span class="inline-wrap"> åœ¨ FROM çš„æœ€å·¦ä¾§ï¼Œ</span><span class="inline-wrap"><code>ShardingSphere</code></span><span class="inline-wrap"> å°†ä¼šä»¥å®ƒä½œä¸ºæ•´ä¸ªç»‘å®šè¡¨çš„ä¸»è¡¨ã€‚ æ‰€æœ‰è·¯ç”±è®¡ç®—å°†ä¼šåªä½¿ç”¨ä¸»è¡¨çš„ç­–ç•¥ï¼Œé‚£ä¹ˆ </span><span class="inline-wrap"><code>t_order_item</code></span><span class="inline-wrap"> è¡¨çš„åˆ†ç‰‡è®¡ç®—å°†ä¼šä½¿ç”¨ </span><span class="inline-wrap"><code>t_order</code></span><span class="inline-wrap"> çš„æ¡ä»¶ã€‚æ•…ç»‘å®šè¡¨ä¹‹é—´çš„åˆ†åŒºé”®è¦å®Œå…¨ç›¸åŒã€‚</span></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å¹¿æ’­è¡¨ï¼šæ‰€æœ‰åˆ†ç‰‡æ•°æ®æºéƒ½æœ‰çš„ä¸”æ•°æ®å®Œå…¨ä¸€æ ·çš„è¡¨ã€‚é€‚ç”¨äºæ•°æ®é‡ä¸å¤§ä¸”éœ€è¦ä¸æµ·é‡æ•°æ®çš„è¡¨è¿›è¡Œå…³è”æŸ¥è¯¢çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼šå­—å…¸è¡¨ã€‚</span></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å•è¡¨ï¼šæ‰€æœ‰åˆ†ç‰‡æ•°æ®æºä¸­åªå­˜åœ¨å”¯ä¸€ä¸€å¼ çš„è¡¨</span></li></ul><h3 class="wolai-block"><span class="inline-wrap">åˆ†ç‰‡é”®</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç”¨äºåˆ†ç‰‡çš„æ•°æ®åº“å­—æ®µï¼Œæ˜¯å°†è¡¨æ°´å¹³æ‹†åˆ†çš„å…³é”®å­—æ®µã€‚ä¾‹ï¼šå°†è®¢å•è¡¨ä¸­çš„è®¢å•ä¸»é”®çš„å°¾æ•°å–æ¨¡åˆ†ç‰‡ï¼Œåˆ™è®¢å•ä¸»é”®ä¸ºåˆ†ç‰‡å­—æ®µã€‚ </span><span class="red inline-wrap">SQL ä¸­å¦‚æœæ— åˆ†ç‰‡å­—æ®µï¼Œå°†æ‰§è¡Œå…¨è·¯ç”±ï¼Œæ€§èƒ½è¾ƒå·®ã€‚</span><span class="inline-wrap"> </span><span class="inline-wrap">é™¤äº†å¯¹å•åˆ†ç‰‡å­—æ®µçš„æ”¯æŒï¼ŒApache ShardingSphere ä¹Ÿæ”¯æŒæ ¹æ®å¤šä¸ªå­—æ®µè¿›è¡Œåˆ†ç‰‡ã€‚</span></div></div><h3 class="wolai-block"><span class="inline-wrap">åˆ†ç‰‡ç®—æ³•</span></h3><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç›®å‰æä¾› 4 ç§åˆ†ç‰‡ç®—æ³•çš„æ¥å£ã€‚ ç”±äºåˆ†ç‰‡ç®—æ³•å’Œä¸šåŠ¡å®ç°ç´§å¯†ç›¸å…³ï¼Œå› æ­¤å¹¶æœªæä¾›å†…ç½®åˆ†ç‰‡ç®—æ³•çš„å®ç°ï¼Œéœ€è¦åº”ç”¨å¼€å‘è€…è‡ªè¡Œå®ç°åˆ†ç‰‡ç®—æ³•ã€‚</span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">ç²¾å‡†åˆ†ç‰‡ç®—æ³• </span><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç”¨äºå¤„ç†ä½¿ç”¨å•ä¸€é”®ä½œä¸ºåˆ†ç‰‡é”®çš„</span><span class="inline-wrap"><code>=</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>IN</code></span><span class="inline-wrap">è¿›è¡Œåˆ†ç‰‡çš„åœºæ™¯ã€‚</span></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">èŒƒå›´åˆ†ç‰‡ç®—æ³• </span><span class="inline-wrap"><code>RangeShardingAlgorithm</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç”¨äºå¤„ç†ä½¿ç”¨å•ä¸€é”®ä½œä¸ºåˆ†ç‰‡é”®çš„ </span><span class="inline-wrap"><code>=</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>IN</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>BETWEEN AND</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>&gt;</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>&lt;</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>&gt;=</code></span><span class="inline-wrap">ã€</span><span class="inline-wrap"><code>&lt;=</code></span><span class="inline-wrap"> è¿›è¡Œåˆ†ç‰‡çš„åœºæ™¯ã€‚</span></div></div><aside class="bg-cultured wolai-block"><div data-symbol="ğŸ’¥" class="icon"></div><span class="inline-wrap">åé¢çœ‹æºç ä½ å°±èƒ½å‘ç°ï¼Œä»–ä»¬è¦å®ç°çš„æ–¹æ³•ï¼Œå‰è€…è¿”å›å•ä¸ªåº“/è¡¨ï¼Œåè€…è¿”å›å¤šä¸ªåº“/è¡¨</span></aside></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å¤åˆåˆ†ç‰‡ç®—æ³• </span><span class="inline-wrap"><code>ComplexKeysShardingAlgorithm</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">ç”¨äºå¤„ç†ä½¿ç”¨å¤šé”®ä½œä¸ºåˆ†ç‰‡é”®è¿›è¡Œåˆ†ç‰‡çš„åœºæ™¯ï¼ŒåŒ…å«å¤šä¸ªåˆ†ç‰‡é”®çš„é€»è¾‘è¾ƒå¤æ‚ï¼Œéœ€è¦åº”ç”¨å¼€å‘è€…è‡ªè¡Œå¤„ç†å…¶ä¸­çš„å¤æ‚åº¦ã€‚</span></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Hint<span class="jill"></span>åˆ†ç‰‡ç®—æ³•</span><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¯¹åº” </span><span class="inline-wrap"><code>HintShardingAlgorithm</code></span><span class="inline-wrap">ï¼Œç”¨äºå¤„ç†ä½¿ç”¨ </span><span class="inline-wrap"><code>Hint</code></span><span class="inline-wrap"> è¡Œåˆ†ç‰‡çš„åœºæ™¯</span></div></div><div class="wolai-bookmark wolai-block"><a href="https://en.wikipedia.org/wiki/Hint_(SQL)">https://en.wikipedia.org/wiki/Hint_(SQL)</a><div class="info-box"><div class="text-pane"><div data-title="en.wikipedia.org"></div><div class="icon-host"><div data-hostname="en.wikipedia.org"></div></div></div><div class="preview-pane"></div></div></div></li></ul><h3 class="wolai-block"><span class="inline-wrap">åˆ†ç‰‡ç­–ç•¥</span></h3><div class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>åˆ†ç‰‡ç­–ç•¥ = åˆ†ç‰‡é”®<span class="jill"></span>+<span class="jill"></span>åˆ†ç‰‡ç®—æ³•</b></span><span class="inline-wrap">ï¼Œç›®å‰æä¾›äº† 5<span class="jill"></span>ç§åˆ†ç‰‡ç­–ç•¥ã€‚</span></div></div><ul class="wolai-block"><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">æ ‡å‡†åˆ†ç‰‡ç­–ç•¥ </span><span class="inline-wrap"><code>StandardShardingStrategy</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">æä¾›å¯¹ SQL è¯­å¥ä¸­çš„ </span><span class="inline-wrap"><code>=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&gt;</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&lt;</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&gt;=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&lt;=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>IN</code></span><span class="inline-wrap"> å’Œ </span><span class="inline-wrap"><code>BETWEEN AND</code></span><span class="inline-wrap"> çš„åˆ†ç‰‡æ“ä½œæ”¯æŒã€‚ </span><span class="inline-wrap"><code>StandardShardingStrategy</code></span><span class="inline-wrap"> åªæ”¯æŒå•åˆ†ç‰‡é”®ï¼Œæä¾› </span><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><span class="inline-wrap"> å’Œ </span><span class="inline-wrap"><code>RangeShardingAlgorithm</code></span><span class="inline-wrap"> ä¸¤ä¸ªåˆ†ç‰‡ç®—æ³•ã€‚</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><span class="inline-wrap"> æ˜¯å¿…é¡»çš„ï¼Œç”¨äºå¤„ç† </span><span class="inline-wrap"><code>=</code></span><span class="inline-wrap"> å’Œ </span><span class="inline-wrap"><code>IN</code></span><span class="inline-wrap"> çš„åˆ†ç‰‡ã€‚ </span><span class="inline-wrap"><code>RangeShardingAlgorithm</code></span><span class="inline-wrap"> æ˜¯å¯é€‰çš„ï¼Œç”¨äºå¤„ç† </span><span class="inline-wrap"><code>BETWEEN AND</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&gt;</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&lt;</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&gt;=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&lt;=</code></span><span class="inline-wrap"> åˆ†ç‰‡ï¼Œå¦‚æœä¸é…ç½® </span><span class="inline-wrap"><code>RangeShardingAlgorithm</code></span><span class="inline-wrap">ï¼ŒSQL ä¸­çš„ </span><span class="inline-wrap"><code>BETWEEN AND</code></span><span class="inline-wrap"> å°†æŒ‰ç…§å…¨åº“è·¯ç”±å¤„ç†ã€‚ï¼ˆéªŒè¯ä¸€ä¸‹ï¼Œæˆ‘è§‰å¾—</span><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><span class="inline-wrap">åªèƒ½å¤„ç†</span><span class="inline-wrap"><code>IN</code></span><span class="inline-wrap">ï¼‰</span></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å¤åˆåˆ†ç‰‡ç­–ç•¥ </span><span class="inline-wrap"><code>ComplexShardingStrategy</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">æä¾›å¯¹ SQL è¯­å¥ä¸­çš„ </span><span class="inline-wrap"><code>=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&gt;</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&lt;</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&gt;=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>&lt;=</code></span><span class="inline-wrap">, </span><span class="inline-wrap"><code>IN</code></span><span class="inline-wrap"> å’Œ </span><span class="inline-wrap"><code>BETWEEN AND</code></span><span class="inline-wrap"> çš„åˆ†ç‰‡æ“ä½œæ”¯æŒã€‚ </span><span class="inline-wrap"><code>ComplexShardingStrategy</code></span><span class="inline-wrap"> æ”¯æŒå¤šåˆ†ç‰‡é”®ï¼Œç”±äºå¤šåˆ†ç‰‡é”®ä¹‹é—´çš„å…³ç³»å¤æ‚ï¼Œå› æ­¤å¹¶æœªè¿›è¡Œè¿‡å¤šçš„å°è£…ï¼Œè€Œæ˜¯ç›´æ¥å°†åˆ†ç‰‡é”®å€¼ç»„åˆä»¥åŠåˆ†ç‰‡æ“ä½œç¬¦é€ä¼ è‡³åˆ†ç‰‡ç®—æ³•ï¼Œå®Œå…¨ç”±åº”ç”¨å¼€å‘è€…å®ç°ï¼Œæä¾›æœ€å¤§çš„çµæ´»åº¦ã€‚</span></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">å†…è”åˆ†ç‰‡ç­–ç•¥ </span><span class="inline-wrap"><code>InlineShardingStrategy</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä½¿ç”¨</span><span class="inline-wrap"><code>ShardingSphere</code></span><span class="inline-wrap">æä¾›çš„è¡Œè¡¨è¾¾å¼è¿›è¡Œåˆ†ç‰‡</span></div></div><div class="wolai-bookmark wolai-block"><a href="https://shardingsphere.apache.org/document/current/cn/features/sharding/concept/inline-expression/">è¡Œè¡¨è¾¾å¼ :: ShardingSphere</a><div class="info-box"><div class="text-pane"><div data-title="è¡Œè¡¨è¾¾å¼ :: ShardingSphere"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://shardingsphere.apache.org/document/current/img/favicon.png&quot;)"></div><div data-hostname="shardingsphere.apache.org"></div></div></div><div class="preview-pane"></div></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Hint<span class="jill"></span>åˆ†ç‰‡ç­–ç•¥</span><span class="inline-wrap"><code>HintShardingStrategy</code></span><div class="wolai-block wolai-text"><div><span class="inline-wrap">é€šè¿‡ Hint æŒ‡å®šåˆ†ç‰‡å€¼è€Œéä» SQL ä¸­æå–åˆ†ç‰‡å€¼çš„æ–¹å¼è¿›è¡Œåˆ†ç‰‡çš„ç­–ç•¥ã€‚</span></div></div></li><li><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">ä¸åˆ†ç‰‡ç­–ç•¥ </span><span class="inline-wrap"><code>NoneShardingStrategy</code></span></li></ul><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><h2 class="wolai-block"><span class="inline-wrap">ShardingSphere-JDBC</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">JDBC<span class="jill"></span>ç¦»ä¸å¼€</span><span class="inline-wrap"><code>DataSource</code></span><span class="inline-wrap">ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä½¿ç”¨<span class="jill"></span>ShardingSphere-JDBC<span class="jill"></span>è¦æ€ä¹ˆåˆ›å»º</span><span class="inline-wrap"><code>DataSource</code></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token punctuation">(</span>access <span class="token operator">=</span> <span class="token class-name">AccessLevel</span><span class="token punctuation">.</span>PRIVATE<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ShardingDataSourceFactory</span> <span class="token punctuation">{</span>
    
    <span class="token doc-comment comment">/**
     * Create sharding data source.
     *
     * <span class="token keyword">@param</span> <span class="token parameter">dataSourceMap</span> data source map
     * <span class="token keyword">@param</span> <span class="token parameter">shardingRuleConfig</span> rule configuration for databases and tables sharding
     * <span class="token keyword">@param</span> <span class="token parameter">props</span> properties for data source
     * <span class="token keyword">@return</span> sharding data source
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">SQLException</span></span> SQL exception
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DataSource</span> <span class="token function">createDataSource</span><span class="token punctuation">(</span>
            <span class="token comment">// Map&lt;æ•°æ®æºåç§°,DataSource></span>
            <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">DataSource</span><span class="token punctuation">></span></span> dataSourceMap<span class="token punctuation">,</span> 
            <span class="token comment">// åˆ†ç‰‡è§„åˆ™é…ç½®</span>
            <span class="token keyword">final</span> <span class="token class-name">ShardingRuleConfiguration</span> shardingRuleConfig<span class="token punctuation">,</span> 
            <span class="token comment">// å±æ€§é…ç½®</span>
            <span class="token keyword">final</span> <span class="token class-name">Properties</span> props<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ShardingDataSource</span><span class="token punctuation">(</span>dataSourceMap<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ShardingRule</span><span class="token punctuation">(</span>shardingRuleConfig<span class="token punctuation">,</span> dataSourceMap<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¯ä»¥çœ‹å‡ºï¼Œæœ€é‡è¦çš„åº”è¯¥å°±æ˜¯</span><span class="inline-wrap"><code>ShardingRuleConfiguration</code></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ShardingRuleConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">RuleConfiguration</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¡¨è§„åˆ™é…ç½®</span>
    <span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TableRuleConfiguration</span><span class="token punctuation">></span></span> tableRuleConfigs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç»‘å®šè¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> bindingTableGroups <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¹¿æ’­è¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> broadcastTables <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// é»˜è®¤æ•°æ®æºåç§°</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> defaultDataSourceName<span class="token punctuation">;</span>
    <span class="token comment">// é»˜è®¤æ•°æ®åº“åˆ†ç‰‡ç­–ç•¥é…ç½®</span>
    <span class="token keyword">private</span> <span class="token class-name">ShardingStrategyConfiguration</span> defaultDatabaseShardingStrategyConfig<span class="token punctuation">;</span>
    <span class="token comment">// é»˜è®¤è¡¨åˆ†ç‰‡é…ç½®ç­–ç•¥</span>
    <span class="token keyword">private</span> <span class="token class-name">ShardingStrategyConfiguration</span> defaultTableShardingStrategyConfig<span class="token punctuation">;</span>
    <span class="token comment">// é»˜è®¤ä¸»é”®ç”Ÿæˆç­–ç•¥</span>
    <span class="token keyword">private</span> <span class="token class-name">KeyGeneratorConfiguration</span> defaultKeyGeneratorConfig<span class="token punctuation">;</span>
    <span class="token comment">// ä¸»ä»è§„åˆ™é…ç½®</span>
    <span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MasterSlaveRuleConfiguration</span><span class="token punctuation">></span></span> masterSlaveRuleConfigs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åŠ å¯†è§„åˆ™é…ç½®</span>
    <span class="token keyword">private</span> <span class="token class-name">EncryptRuleConfiguration</span> encryptRuleConfig<span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">å…ˆæ¥çœ‹ä¸‹ </span><span class="inline-wrap"><code>TableRuleConfiguration</code></span><span class="inline-wrap"> é‡Œé¢æœ‰ä»€ä¹ˆ</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">TableRuleConfiguration</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> logicTable<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> actualDataNodes<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token class-name">ShardingStrategyConfiguration</span> databaseShardingStrategyConfig<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token class-name">ShardingStrategyConfiguration</span> tableShardingStrategyConfig<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token class-name">KeyGeneratorConfiguration</span> keyGeneratorConfig<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">TableRuleConfiguration</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> logicTable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>logicTable<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">TableRuleConfiguration</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> logicTable<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">String</span> actualDataNodes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>logicTable<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"LogicTable is required."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>logicTable <span class="token operator">=</span> logicTable<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>actualDataNodes <span class="token operator">=</span> actualDataNodes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>TableRuleConfiguration</code></span><span class="inline-wrap">å±…ç„¶ä¹Ÿæœ‰</span><span class="inline-wrap"><code>ShardingStrategyConfiguration</code></span><span class="inline-wrap">å’Œ</span><span class="inline-wrap"><code>KeyGeneratorConfiguration</code></span><span class="inline-wrap">ï¼Œçœ‹æ¥è¿™ä¸¤ä¸ªä¸œè¥¿çœŸçš„å¾ˆé‡è¦</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>ShardingStrategyConfiguration</code></span><span class="inline-wrap"> æ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼Œé‡Œé¢æ²¡æœ‰ä»»ä½•æ–¹æ³•å’Œæˆå‘˜å˜é‡ï¼Œä¸éš¾æƒ³è±¡å®ƒçš„å®ç°ç±»åº”è¯¥æ˜¯ç”±æ¡†æ¶æä¾›çš„ï¼Œè€Œä¸”å¯¹å®ç°ç±»çš„ä½¿ç”¨åº”è¯¥æ˜¯ç¡¬ç¼–ç åœ¨æ¡†æ¶é‡Œé¢çš„</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ShardingStrategyConfiguration</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">æˆ‘ä»¬æ¥çœ‹çœ‹ä»–æœ‰å“ªäº›å®ç°ç±»</span></div></div><div class="wolai-block wolai-center"><figure><img src="media/image.png" style="width: 760px"/></figure></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">æ ¹æ®åç§°ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸ªæœ€åŸºæœ¬çš„å®ç°ç±»</span><span class="inline-wrap"><code>StandardShardingStrategyConfiguration</code></span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">StandardShardingStrategyConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">ShardingStrategyConfiguration</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> shardingColumn<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">PreciseShardingAlgorithm</span> preciseShardingAlgorithm<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RangeShardingAlgorithm</span> rangeShardingAlgorithm<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">StandardShardingStrategyConfiguration</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> shardingColumn<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">PreciseShardingAlgorithm</span> preciseShardingAlgorithm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>shardingColumn<span class="token punctuation">,</span> preciseShardingAlgorithm<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">StandardShardingStrategyConfiguration</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> shardingColumn<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">PreciseShardingAlgorithm</span> preciseShardingAlgorithm<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">RangeShardingAlgorithm</span> rangeShardingAlgorithm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">isNullOrEmpty</span><span class="token punctuation">(</span>shardingColumn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ShardingColumns is required."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkNotNull</span><span class="token punctuation">(</span>preciseShardingAlgorithm<span class="token punctuation">,</span> <span class="token string">"PreciseShardingAlgorithm is required."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>shardingColumn <span class="token operator">=</span> shardingColumn<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>preciseShardingAlgorithm <span class="token operator">=</span> preciseShardingAlgorithm<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>rangeShardingAlgorithm <span class="token operator">=</span> rangeShardingAlgorithm<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">çœ‹åˆ°å®ƒè¿™ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼Œä¸ç¦æƒ³èµ·å‰é¢çœ‹åˆ°çš„ï¼Œ</span><span class="inline-wrap"><b>åˆ†ç‰‡ç­–ç•¥ = åˆ†ç‰‡ä¸»é”®<span class="jill"></span>+<span class="jill"></span>åˆ†ç‰‡ç®—æ³•</b></span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¯ä»¥çœ‹å‡º</span><span class="inline-wrap"><code>StandardShardingStrategyConfiguration</code></span><span class="inline-wrap">å®ƒæœ‰ä¸¤ä¸ªåˆ†ç‰‡ç®—æ³•ï¼Œåˆ†åˆ«æ˜¯ç²¾å‡†åˆ†ç‰‡ç®—æ³•(</span><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><span class="inline-wrap">)å’ŒèŒƒå›´åˆ†é…ç®—æ³•(</span><span class="inline-wrap"><code>RangeShardingAlgorithm</code></span><span class="inline-wrap">)</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PreciseShardingAlgorithm</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token keyword">extends</span> <span class="token class-name">ShardingAlgorithm</span> <span class="token punctuation">{</span>
    
    <span class="token doc-comment comment">/**
     * Sharding.
     * 
     * <span class="token keyword">@param</span> <span class="token parameter">availableTargetNames</span> available data sources or tables's names
     * <span class="token keyword">@param</span> <span class="token parameter">shardingValue</span> sharding value
     * <span class="token keyword">@return</span> sharding result for data source or table's name
     */</span>
    <span class="token class-name">String</span> <span class="token function">doSharding</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> availableTargetNames<span class="token punctuation">,</span> <span class="token class-name">PreciseShardingValue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> shardingValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ShardingAlgorithm</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap"><code>ShardingAlgorithm</code></span><span class="inline-wrap">ä¹Ÿæ˜¯ä¸ªç©ºæ¥å£ï¼Œä½†æ˜¯</span><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><span class="inline-wrap">ä¸æ˜¯ç©ºæ¥å£ï¼Œçœ‹æ¥è¿™ä¸ªæ¥å£å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„äº†ï¼Œçœ‹åˆ°è¿™é‡Œä¸ç¦åˆæƒ³èµ·å‰é¢çœ‹åˆ°çš„</span></div></div><blockquote class="wolai-block"><span class="inline-wrap">ç”±äºåˆ†ç‰‡ç®—æ³•å’Œä¸šåŠ¡å®ç°ç´§å¯†ç›¸å…³ï¼Œå› æ­¤å¹¶æœªæä¾›å†…ç½®åˆ†ç‰‡ç®—æ³•ï¼Œè€Œæ˜¯é€šè¿‡åˆ†ç‰‡ç­–ç•¥å°†å„ç§åœºæ™¯æç‚¼å‡ºæ¥ï¼Œæä¾›æ›´é«˜å±‚çº§çš„æŠ½è±¡ï¼Œå¹¶æä¾›æ¥å£è®©åº”ç”¨å¼€å‘è€…è‡ªè¡Œå®ç°åˆ†ç‰‡ç®—æ³•</span></blockquote><div class="wolai-block wolai-text"><div><span class="inline-wrap">æ¥æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬ç›®å‰å­¦åˆ°çš„å†…å®¹</span></div></div><ol class="wolai-block"><li><div class="marker"></div><span class="inline-wrap">å…³é”®çš„ç±»åŠå…¶å…³è”å…³ç³»</span><div class="wolai-block wolai-text"><div><span class="inline-wrap">ShardingDataSource â†’ ShardingRuleConfiguration â†’ TableRuleConfiguration â†’ ShardingStrategyConfiguration â†’ ShardingAlgorithm</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">TableRuleConfigurationï¼šé’ˆå¯¹æŸå¼ è¡¨çš„è§„åˆ™çš„é…ç½®</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ShardingStrategyConfigurationï¼šåˆ†ç‰‡ç­–ç•¥</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ShardingAlgorithmï¼šåˆ†ç‰‡ç®—æ³•</span></div></div></li><li><div class="marker"></div><span class="inline-wrap">æ ¸å¿ƒæ€æƒ³</span><div class="wolai-block wolai-text"><div><span class="inline-wrap">ShardingSphere-JDBC<span class="jill"></span>ä¼šç»™ä½ ä¸€äº›ä¿¡æ¯ï¼Œç„¶åä½ æ ¹æ®è¿™äº›ä¿¡æ¯è®¡ç®—å‡ºè¦æŸ¥å“ªä¸ªè¡¨ï¼Œå¹¶åé¦ˆç»™å®ƒ</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">æˆ‘ä¼šå¾—åˆ°å“ªäº›ä¿¡æ¯ï¼Ÿæˆ‘è¦å¦‚ä½•åé¦ˆå®ƒæŸ¥å“ªå¼ è¡¨ï¼Ÿ</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">ä¸Šé¢è¿™ä¸€æ­¥å…¶å®å°±æ˜¯å‘ç”Ÿåœ¨</span><span class="inline-wrap"><code>ShardingAlgorithm</code></span><span class="inline-wrap">é‡Œé¢çš„ï¼Œä»¥</span><span class="inline-wrap"><code>PreciseShardingAlgorithm</code></span><span class="inline-wrap">ä¸ºä¾‹</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Java" class="marker"></div><pre><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PreciseShardingAlgorithm</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token keyword">extends</span> <span class="token class-name">ShardingAlgorithm</span> <span class="token punctuation">{</span>
    
    <span class="token doc-comment comment">/**
     * Sharding.
     * 
     * <span class="token keyword">@param</span> <span class="token parameter">availableTargetNames</span> available data sources or tables's names
     * <span class="token keyword">@param</span> <span class="token parameter">shardingValue</span> sharding value
     * <span class="token keyword">@return</span> sharding result for data source or table's name
     */</span>
    <span class="token class-name">String</span> <span class="token function">doSharding</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> availableTargetNames<span class="token punctuation">,</span> <span class="token class-name">PreciseShardingValue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> shardingValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><div class="wolai-block wolai-text"><div><span class="inline-wrap">å¯ä»¥çœ‹å‡ºï¼Œå®ƒç»™ä½ æ•°æ®æºæˆ–è€…è¡¨åä»¥åŠå€¼ï¼Œä½ è¿”å›ä¸€ä¸ªæ•°æ®æºåç§°æˆ–è¡¨å</span></div></div></li></ol><h2 class="wolai-block"><span class="inline-wrap">å®æˆ˜-åˆ†åº“åˆ†è¡¨</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">å‡ ä¸ªåº“ï¼Ÿå‡ å¼ è¡¨ï¼Ÿæ¯å¼ è¡¨åˆ†æˆå¤šå°‘ä»½ï¼Ÿ</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">å…ˆæŠŠè¡¨ç¡®è®¤ä¸‹æ¥å§ï¼Œè¦æœ‰ç»‘å®šè¡¨</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">è®¢å•è¡¨ã€è®¢å•å•†å“è¡¨</span></div></div><div class="wolai-bookmark wolai-block"><a href="https://github.com/macrozheng/mall-learning">https://github.com/macrozheng/mall-learning</a><div class="info-box"><div class="text-pane"><div data-title="github.com"></div><div class="icon-host"><div data-hostname="github.com"></div></div></div><div class="preview-pane"></div></div></div><h2 class="wolai-block"><span class="inline-wrap">å®æˆ˜-è¯»å†™åˆ†ç¦»</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></article><footer></footer></body></html>