<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>Git - wolai 笔记</title><link rel="shortcut icon"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="Git" class="main-title"></div></div></header><article><h2 class="wolai-block"><span class="inline-wrap">Git<span class="jill"></span>仓库中文件的类型</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">在<span class="jill"></span>Git<span class="jill"></span>仓库里面，文件有两种类型，分别是已跟踪和未跟踪。</span></div></div><div class="wolai-block wolai-text"><div><span class="inline-wrap">对于已跟踪的文件又有三种类型，分别是为未修改、已修改、暂存</span></div></div><div class="wolai-block wolai-center"><figure><img src="https://git-scm.com/book/en/v2/images/lifecycle.png" style="width: 484px"/></figure></div><h2 class="wolai-block"><span class="inline-wrap">常用设置</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 修改时间样式 一劳永逸</span>
<span class="token function">git</span> config --global log.date iso 
<span class="token comment"># 使用vim作为编辑器</span>
<span class="token function">git</span> config --global core.editor <span class="token string">"vim"</span>

<span class="token comment"># 修复windows中文乱码</span>
<span class="token function">git</span> config --global core.quotepath <span class="token boolean">false</span>
<span class="token function">git</span> config --global gui.encoding utf-8
<span class="token function">git</span> config --global i18n.commit.encoding utf-8
<span class="token function">git</span> config --global i18n.logoutputencoding utf-8
<span class="token comment"># 添加环境变量LESSCHARSET=utf-8</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">仓库相关的操作</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 新建仓库</span>
<span class="token function">git</span> init
<span class="token comment"># 克隆别人的仓库</span>
<span class="token function">git</span> clone https://github.com/libgit2/libgit2
<span class="token comment"># 查看远程仓库</span>
<span class="token function">git</span> remote -v
<span class="token comment"># 添加远程仓库</span>
<span class="token function">git</span> remote <span class="token function">add</span> <span class="token operator">&lt;</span>shortname<span class="token operator">></span> <span class="token operator">&lt;</span>url<span class="token operator">></span>
<span class="token comment"># 查看远程仓库详细信息</span>
<span class="token function">git</span> remote show <span class="token punctuation">[</span>remote-name<span class="token punctuation">]</span>
<span class="token comment"># 上传到远程仓库</span>
<span class="token function">git</span> push <span class="token punctuation">[</span>remote-name<span class="token punctuation">]</span> <span class="token punctuation">[</span>branch-name<span class="token punctuation">]</span>
<span class="token comment"># 从远程仓库中拉取代码</span>
<span class="token function">git</span> fetch <span class="token punctuation">[</span>remote-name<span class="token punctuation">]</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">删除文件相关操作</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 删除工作区中未追踪的文件</span>
<span class="token function">git</span> clean -n  <span class="token comment"># 查看会删除哪些文件</span>
<span class="token function">git</span> clean -f  <span class="token comment"># 删除文件</span>
<span class="token function">git</span> clean -fd <span class="token comment"># 删除文件和目录</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">日志相关的操作</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 查看所有的提交，最近的提交排在最上面。</span>
<span class="token function">git</span> log 
<span class="token comment"># 查看仓库从克隆到目前，所有的提交和回滚操作</span>
<span class="token function">git</span> reflog
<span class="token comment"># 查看最近两次提交</span>
<span class="token function">git</span> log -2
<span class="token comment"># 列出每次提交被修改的文件</span>
<span class="token function">git</span> log --stat
<span class="token comment"># 列出每次提交被修改的文件的内容差异</span>
<span class="token function">git</span> log -p
<span class="token comment"># 骚操作</span>
<span class="token function">git</span> log --oneline --graph</pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">提交相关操作</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># --------------------------------- 提交 ---------------------</span>
<span class="token comment"># 提交文件到版本库</span>
<span class="token function">git</span> commit -m<span class="token string">"commit message"</span>
<span class="token comment"># 提交或修改上一次提交信息</span>
<span class="token comment"># 这个命令会将暂存区中的文件提交。 如果自上次提交以来你还未做任何修改（例如，在上次提交后马上执行了此命令），那么快照会保持不变，而你所修改的只是提交信息。</span>
<span class="token function">git</span> commit --amend -m<span class="token string">"上一次提交信息有误，这次才是正确的"</span>
<span class="token comment"># 合并多次提交 假设 FirstCommit->X -> Y -> Z  想把 Y Z合并为一次提交</span>
<span class="token function">git</span> rebase -i commit-id-of-X </pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">回滚相关操作</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 撤销文件的修改（还没add）</span>
<span class="token function">git</span> checkout file_path
<span class="token comment"># 回滚某个文件的add</span>
<span class="token function">git</span> reset HEAD  file_path
<span class="token comment"># 回滚所有add</span>
<span class="token function">git</span> reset HEAD
<span class="token comment"># 单个文件版本回滚</span>
<span class="token function">git</span> checkout commit_id file_path
<span class="token comment"># 版本回滚</span>
<span class="token function">git</span> reset --hard <span class="token punctuation">[</span>commit-id<span class="token punctuation">]</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">分支相关操作</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 创建分支</span>
<span class="token function">git</span> branch <span class="token operator">&lt;</span>branch-name<span class="token operator">></span>
<span class="token comment"># 查看所有分支</span>
<span class="token function">git</span> branch -a 
<span class="token comment"># 切换分支</span>
<span class="token function">git</span> checkout <span class="token operator">&lt;</span>branch-name<span class="token operator">></span>
<span class="token comment"># 在本地新建的方式获取远程分支</span>
<span class="token function">git</span> checkout -t origin/release-20200228
<span class="token comment"># 删除分支</span>
<span class="token function">git</span> branch -d <span class="token operator">&lt;</span>branch-name<span class="token operator">></span>
<span class="token comment"># 合并分支</span>
<span class="token function">git</span> merge <span class="token operator">&lt;</span>target-branch-name<span class="token operator">></span> <span class="token comment"># 把目标分支合并到当前分支,会产生一个新的提交点</span>
<span class="token function">git</span> rebase <span class="token operator">&lt;</span>target-branch-name<span class="token operator">></span> <span class="token comment"># </span>
<span class="token comment"># 推送新创建的分支</span>
<span class="token function">git</span> push <span class="token comment"># 然后git的提示进行后续操作</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">储藏</span></h2><div class="wolai-block wolai-text"><div><span class="inline-wrap">经常有这样的事情发生，当你正在进行项目中某一部分的工作，里面的东西处于一个比较杂乱的状态，而你想转到其他分支上进行一些工作。问题是，你不想提交进行了一半的工作，否则以后你无法回到这个工作点。解决这个问题的办法就是</span><span class="inline-wrap"><code>git stash</code></span><span class="inline-wrap">命令。</span></div></div><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token function">git</span> stash <span class="token comment"># 储藏</span>
<span class="token function">git</span> stash list <span class="token comment"># 列出储藏记录</span>
<span class="token function">git</span> stash apply <span class="token variable">${stash_id}</span> <span class="token comment"># 使用储藏</span>
<span class="token function">git</span> stash drop <span class="token variable">${stash_id}</span> <span class="token comment"># 删除储藏记录</span>
<span class="token function">git</span> stash pop <span class="token variable">${stash_id}</span> <span class="token comment"># 使用储藏并删除储藏记录</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">权限认证</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token function">git</span> config --global credential.helper store --file ~/.my-credentials</pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">子模块</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token comment"># 添加子模块,添加完毕后，除了项目，还会有一个叫.gitmodules的文件，上面记录着子模块的信息</span>
<span class="token function">git</span> submodule <span class="token function">add</span> https://github.com/chaconinc/DbConnector
<span class="token comment"># 获取具有子模块的仓库</span>
<span class="token function">git</span> clone xxxx
<span class="token function">git</span> submodule init
<span class="token function">git</span> submodule update <span class="token comment"># 获取的子模块跟你提交的时候一模一样</span>
<span class="token comment"># 简写</span>
<span class="token function">git</span> clone --recurse-submodules https://github.com/chaconinc/MainProject
<span class="token comment"># 其他内容https://git-scm.com/book/en/v2/Git-Tools-Submodules</span></pre></div></code-block><h2 class="wolai-block"><span class="inline-wrap">搭建个人远程<span class="jill"></span>Git<span class="jill"></span>仓库</span></h2><code-block class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre><span class="token function">sudo</span> adduser <span class="token function">git</span>
<span class="token function">sudo</span> <span class="token function">git</span> init --bare sample.git
<span class="token function">sudo</span> <span class="token function">chown</span> -R git:git sample.git
<span class="token function">git</span> remote <span class="token function">add</span> origin master git@serverIp:/sample.git</pre></div></code-block><div class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>